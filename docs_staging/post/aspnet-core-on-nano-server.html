<!DOCTYPE html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ASP.NET Core on Nano Server Preview</title><meta name=description content="Deploy an ASP.NET Core web application to a Microsoft Azure Nano Server virtual machine and learn how to safely manage Nano Server using a WS 2012 R2 VM."><meta property=og:locale content=en><meta property=og:site_name content="the guardrex chew"><meta property=og:title content="ASP.NET Core on Nano Server Preview"><link rel=canonical href="http://www.guardrex.com/"><meta property=og:url content="http://www.guardrex.com/"><meta name=twitter:site content=@guardrex><meta name=twitter:title content="ASP.NET Core on Nano Server Preview"><meta name=twitter:description content="Deploy an ASP.NET Core web application to a Microsoft Azure Nano Server virtual machine and learn how to safely manage Nano Server using a WS 2012 R2 VM."><meta name=twitter:url content="http://www.guardrex.com/"><meta name=twitter:card content=summary><meta name=twitter:image content=http://rexsite.azureedge.net/image/twitter600x335.png><meta property=og:image content=http://rexsite.azureedge.net/image/og.png><link rel=apple-touch-icon sizes=57x57 href=http://rexsite.azureedge.net/image/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=114x114 href=http://rexsite.azureedge.net/image/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=72x72 href=http://rexsite.azureedge.net/image/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=144x144 href=http://rexsite.azureedge.net/image/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=60x60 href=http://rexsite.azureedge.net/image/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=120x120 href=http://rexsite.azureedge.net/image/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=76x76 href=http://rexsite.azureedge.net/image/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=152x152 href=http://rexsite.azureedge.net/image/apple-touch-icon-152x152.png><link rel=icon type=image/png href=http://rexsite.azureedge.net/image/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=http://rexsite.azureedge.net/image/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=http://rexsite.azureedge.net/image/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=http://rexsite.azureedge.net/image/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=http://rexsite.azureedge.net/image/favicon-128.png sizes=128x128><meta name=application-name content="the guardrex chew"><meta name=msapplication-TileColor content=#FFFFFF><meta name=msapplication-TileImage content=http://rexsite.azureedge.net/image/mstile-144x144.png><meta name=msapplication-square70x70logo content=http://rexsite.azureedge.net/image/mstile-70x70.png><meta name=msapplication-square150x150logo content=http://rexsite.azureedge.net/image/mstile-150x150.png><meta name=msapplication-wide310x150logo content=http://rexsite.azureedge.net/image/mstile-310x150.png><meta name=msapplication-square310x310logo content=http://rexsite.azureedge.net/image/mstile-310x310.png><meta name=msapplication-notification content="polling-uri=http://www.guardrex.com/rss.xml"><style>body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:17px;line-height:1.5;color:#445;margin:0;background:url(http://rexsite.azureedge.net/image/logo-head.png) no-repeat left top fixed}h1,h2,h3,h4,h5,h6{font-weight:500;line-height:1.1;margin-top:10px;margin-bottom:10px}h1{font-size:28px}h2{font-size:26px}h3{font-size:22px}.container{padding:0 15px;margin:0 auto;max-width:800px;background-color:#fff;opacity:0.95}row{margin-right:-15px;margin-left:-15px}p{margin:0 0 10px}a{color:#337ab7;text-decoration:none}a:hover,a:focus{text-decoration:underline}img{vertical-align:middle;border:0;opacity:1;transition:opacity 0.3s}img[data-src]{opacity:0}.btn{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.5;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid #ccc;border-radius:4px;color:#333}.btn:hover,.btn:focus,.btn.focus{background-color:#eee;text-decoration:none}ol li{margin:20px 0 20px -25px}table th{text-align:center;border-bottom:1px solid gray}table td:not(:first-child){padding-left:10px}#social_top,#social_bottom td{padding-top:10px}.note,.tip,.warning{border:1px solid gray;padding:10px;margin:10px 0}.note em,.tip em,.warning em{font-size:1.4em}.warning em{color:red}#title{line-height:57px;font-size:36px}#author{font-size:14px;margin-top:5px}@media (max-width:600px){#title,h2{font-size:26px}}@media (max-width:490px){#title,h2{font-size:20px}}@media (max-width:420px){#logo{width:40px;height:40px}#title{font-size:16px;line-height:40px}#author{font-size:12px;margin-top:0}}.nostyle,.nostyle:hover{color:black}code[class*="language-"],pre[class*="language-"]{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;text-align:left;word-break:break-all;word-wrap:break-word;white-space:pre-wrap;word-spacing:normal;line-height:1.5;tab-size:4;hyphens:none}@media print{code[class*="language-"],pre[class*="language-"]{text-shadow:none}}pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto}:not(pre) > code[class*="language-"],pre[class*="language-"]{background:#F6F6F6;border:1px solid #888;border-radius:.3em}:not(pre) > code[class*="language-"]{padding:.1em;white-space:normal}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray}.token.punctuation{color:#999}.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#DD4A68}.token.regex,.token.important,.token.variable{color:#e90}.token.important,.token.bold{font-weight:bold}.token.italic{font-style:italic}.token.entity{cursor:help}</style><script>var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-48425827-1']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src='https://ssl.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script><div class=container><header><div id=header_container class=container style="border-bottom:1px solid lightgray;cursor:pointer"><div id=author style=float:right;font-style:italic;text-align:right>Luke Latham<br> <a href=https://twitter.com/guardrex>@guardrex</a></div><a href="/" class=nostyle style=text-decoration:none> <img id=logo src=http://rexsite.azureedge.net/image/apple-touch-icon-57x57.png alt="guardrex logo" width=57 height=57 style=float:left><div id=title style=color:green;font-family:courier;margin:0>the guardrex chew</div></a></div></header><table id=social_top><tbody><tr><td><a href="https://twitter.com/home?status=Check%20out%20%40guardrex%20blog%20post%20ASP%2ENET%20Core%20on%20Nano%20Server"><svg role=img aria-labelledby="twitter twitter_desc" height=28 width=28 xmlns=http://www.w3.org/2000/svg viewBox="0 0 28 28"><title id=twitter>Tweet</title><desc id=twitter_desc>Share on Twitter</desc><path fill=#26c4f1 d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62a15.093 15.093 0 0 1-8.86-2.32c2.702.18 5.375-.648 7.507-2.32a5.417 5.417 0 0 1-4.49-3.64c.802.13 1.62.077 2.4-.154a5.416 5.416 0 0 1-4.412-5.11 5.43 5.43 0 0 0 2.168.387A5.416 5.416 0 0 1 2.89 4.498a15.09 15.09 0 0 0 10.913 5.573 5.185 5.185 0 0 1 3.434-6.48 5.18 5.18 0 0 1 5.546 1.682 9.076 9.076 0 0 0 3.33-1.317 5.038 5.038 0 0 1-2.4 2.942 9.068 9.068 0 0 0 3.02-.85 5.05 5.05 0 0 1-2.48 2.71z" /></svg></a><td><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html"><svg role=img aria-labelledby="facebook facebook_desc" height=29 width=29 xmlns=http://www.w3.org/2000/svg viewBox="0 0 29 29"><title id=facebook>Facebook</title><desc id=facebook_desc>Share on Facebook</desc><path fill=#306199 d="M26.4 0H2.6C1.714 0 0 1.715 0 2.6v23.8c0 .884 1.715 2.6 2.6 2.6h12.393V17.988h-3.996v-3.98h3.997v-3.062c0-3.746 2.835-5.97 6.177-5.97 1.6 0 2.444.173 2.845.226v3.792H21.18c-1.817 0-2.156.9-2.156 2.168v2.847h5.045l-.66 3.978h-4.386V29H26.4c.884 0 2.6-1.716 2.6-2.6V2.6c0-.885-1.716-2.6-2.6-2.6z" /></svg></a><td><a href="https://plus.google.com/share?url=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html"><svg role=img aria-labelledby="google google_desc" xmlns=http://www.w3.org/2000/svg width=24 height=24 viewBox="0 0 24 24"><title id=google>Google+</title><desc id=google_desc>Share on Google+</desc><path fill=#e93f2e d="M21 8.29h-1.95v2.6h-2.6v1.82h2.6v2.6H21v-2.6h2.6v-1.885H21V8.29zM7.614 10.306v2.925h3.9c-.26 1.69-1.755 2.925-3.9 2.925-2.34 0-4.29-2.016-4.29-4.354s1.885-4.353 4.29-4.353c1.104 0 2.014.326 2.794 1.105l2.08-2.08c-1.3-1.17-2.924-1.883-4.874-1.883C3.65 4.586.4 7.835.4 11.8s3.25 7.212 7.214 7.212c4.224 0 6.953-2.988 6.953-7.082 0-.52-.065-1.104-.13-1.624H7.614z"></path></svg></a><td><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html&amp;title=ASP%2ENET%20Core%20on%20Nano%20Server&amp;summary=Check%20out%20%40guardrex%20blog%20post%20ASP%2ENET%20Core%20on%20Nano%20Server&amp;source=!social_source"><svg role=img aria-labelledby="linkedin linkedin_desc" xmlns=http://www.w3.org/2000/svg width=28 height=28 viewBox="0 0 28 28"><title id=linkedin>Linkedin</title><desc id=linkedin_desc>Share on Linkedin</desc><path fill=#007bb6 d="M25.424 15.887v8.447h-4.896v-7.882c0-1.98-.71-3.33-2.48-3.33-1.354 0-2.158.91-2.514 1.802-.13.315-.162.753-.162 1.194v8.216h-4.9s.067-13.35 0-14.73h4.9v2.087c-.01.017-.023.033-.033.05h.032v-.05c.65-1.002 1.812-2.435 4.414-2.435 3.222 0 5.638 2.106 5.638 6.632zM5.348 2.5c-1.676 0-2.772 1.093-2.772 2.54 0 1.42 1.066 2.538 2.717 2.546h.032c1.71 0 2.77-1.132 2.77-2.546C8.056 3.593 7.02 2.5 5.344 2.5h.005zm-2.48 21.834h4.896V9.604H2.867v14.73z"></path></svg></a></table><article><h1>ASP.NET Core on Nano Server Preview</h1><p>By: Luke Latham (@guardrex)<br><em>Published:</em> 4/11/2016 <em>Last updated:</em> 4/11/2016<p>In this tutorial, you'll deploy an ASP.NET Core web application to a Microsoft Azure Nano Server virtual machine and learn how to safely manage Nano Server using a Microsoft Azure Windows Server 2012 R2 virtual machine.<p>In this article:<div class=note><p><em>Note</em></p>This topic applies to the Preview release of Nano Server. Most of the steps should remain the same. See the <a href=#additional-resources>Additional Resources</a> section for links to the latest guidance for Nano Server. I hope to find time to update this topic to the release version of Nano Server and ASP.NET Core 2.0 in the coming weeks.</div><ul><li><a href=#introduction>Introduction</a><li><a href=#azure-services-configuration>Azure Services Configuration</a><li><a href=#create-a-microsoft-azure-windows-server-2012-r2-vm>Create a Microsoft Azure Windows Server 2012 R2 VM</a><li><a href=#create-a-microsoft-azure-nano-server-vm>Create a Microsoft Azure Nano Server VM</a><li><a href=#mount-the-azure-files-share-locally>Mount the Azure Files share locally</a><li><a href=#access-the-nano-server-and-mount-the-azure-files-share>Access the Nano Server and mount the Azure Files share</a><li><a href=#install-nano-server-packages>Install Nano Server packages</a><li><a href=#install-the-aspnetcoremodule>Install the AspNetCoreModule</a><li><a href=#deploy-an-asp-net-core-core-clr-app>Deploy an ASP.NET Core Core CLR app</a><li><a href=#clean-up>Clean up</a><li><a href=#nano-server-management>Nano Server Management</a><li><a href=#useful-iis-powershell-commands>Useful IIS PowerShell Commands</a><li><a href=#additional-resources>Additional Resources</a><li><a href=#acknowledgements>Acknowledgements</a></ul><a id=introduction></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#introduction class=nostyle>Introduction</a></h2><a id=prerequisites></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#prerequisites class=nostyle>Prerequisites</a></h3><p>Before you start, make sure that you have setup your development environment and created (or obtained) a working ASP.NET Core 64-bit Core CLR app.<p>You will need a Microsoft Azure account to create the Azure Virtual Machines (servers) in this tutorial. If you don't have an Azure account, you can sign up at the <a href="https://azure.microsoft.com/en-us/pricing/free-trial/">Microsoft Azure website</a>. If you would like information on signing up for an Azure account as an organization, see <a href="https://azure.microsoft.com/en-us/documentation/articles/sign-up-organization/">Sign up for Azure as an organization</a>.</p><a id=nano-server></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#nano-server class=nostyle>Nano Server</a></h3><p>Windows Server is an all-purpose industry standard operating system for production IT workloads and a feat of engineering. As Windows Server has grown to encompass a vast array of solutions to meet IT demands, it has also grown in size and complexity. A craving exists now for a significantly smaller and faster version of Windows Server for cloud-based workloads. Nano Server was born for this purpose.<p>Nano Server is an optimized version of Windows Server for private clouds and datacenters. Nano Server features vastly reduced disk space requirements, fewer update requirements, added uptime due to reduced server restarts, and faster performance owing to fewer running processes. Nano Server is ideal as a compute host Hyper-V Virtual Machine, storage host, DNS server, or host for applications running behind IIS (or outside of IIS) inside or outside of a container.<p>This tutorial will walk you through setting up a Microsoft Azure Nano Server Virtual Machine and deploying an ASP.NET Core application to your Nano Server. Because Nano Server is a "headless server," which means that no graphical user interface is available, we'll also spin up a Microsoft Azure Windows Server 2012 R2 Virtual Machine to safely manage our Nano Server. This tutorial cross-demonstrates important security concepts for reducing the attack surface of your Nano Server.<p>Follow this tutorial to get started quickly with ASP.NET Core on Nano Server. Visit the linked content in the Additional Resources section at the end of the tutorial to learn more about Nano Server.</p><a id=windows-server-2016-nano-server-technical-preview></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#windows-server-2016-nano-server-technical-preview class=nostyle>Windows Server 2016 (Nano Server) Technical Preview</a></h3><p>Nano Server is distributed with the <a href=https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-technical-preview>Windows Server 2016 Technical Preview (TP4)</a>. The preview will expire on October 15, 2016. The preview is not eligible for use in production environments, and preview upgrades are not supported (i.e., upgrading from or to a Windows Server 2016 preview will not preserve custom configurations). Read the <a href=https://technet.microsoft.com/library/dn765470.aspx>release notes</a> and <a href=https://technet.microsoft.com/library/mt126134(WS.11).aspx>system requirements</a> before proceeding with this tutorial.</p><a id=deployment-options-for-nano-server></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#deployment-options-for-nano-server class=nostyle>Deployment options for Nano Server</a></h3><p>This tutorial demonstrates deploying an ASP.NET Core application to Nano Server running on a Microsoft Azure Resource Manager (ARM) Virtual Machine (VM). Other options include deployment to an on-premises Hyper-V virtual machine or Server Core on a physical computer. For more information on these alternative deployment options, see <a href=https://technet.microsoft.com/en-us/library/mt126167.aspx>Getting Started with Nano Server</a>.</p><a id=windows-powershell-remoting></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#windows-powershell-remoting class=nostyle>Windows PowerShell Remoting</a></h3><p>This tutorial demonstrates interacting with Nano Server via Windows PowerShell remoting using the Remote PowerShell Tab feature of the <a href=https://technet.microsoft.com/en-us/library/dd315244.aspx>PowerShell Integrated Scripting Environment (ISE)</a> application.<p>If you prefer not to work with the PowerShell ISE Remote PowerShell Tab feature or if you are using Windows PowerShell, you can manually create a session with your Nano Server by using the following commands (but this approach is not used in this tutorial).<pre class=language-powershell><code>$a = "&lt;NANO_SERVER_DNS_ADDRESS&gt;"
Set-Item WSMan:\localhost\Client\TrustedHosts $a
$s = New-PSSession -ComputerName $a -Credential &lt;username&gt;
Enter-PSSession -Session $s</code></pre><p>For information on additional ways to interact with Nano Server, see <a href=https://technet.microsoft.com/en-us/library/mt126167.aspx>Getting Started with Nano Server</a>.</p><a id=working-with-files-and-folders></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#working-with-files-and-folders class=nostyle>Working with files and folders</a></h3><p>This tutorial utilizes a Server Message Block (SMB) file share using Microsoft Azure Files. An SMB file share is a convenient way to share files across computers on a network, including the Internet.<div class=note><p><em>Note</em></p>If you install PowerShell v5.0 on the management VM, be aware that PowerShell v5.0 introduces a new feature in the <code>Copy-Item</code> command that also allows files and folders to be moved in and out of a remote PowerShell session (but this approach is not used in this tutorial). For more information on using <code class=language-powershell>Copy-Item</code>'s new <code class=language-powershell>-ToSession</code> and <code class=language-powershell>-FromSession</code> extensions, see <a href=http://blogs.technet.com/b/poshchap/archive/2015/10/30/copy-from-one-powershell-session-to-another.aspx>Copy To or From a PowerShell Session</a>.</div><p>When working with a network share to move files and folders, you can drag-and-drop files and folders to a mapped network drive (locally only, because Nano Server doesn't have a GUI) or use PowerShell (locally or remotely). The commands shown below work equally well in a local or remote PowerShell tab.<p>Use the <code class=language-powershell>Copy-Item</code> command to move files and folders to or from the share. In PowerShell, the period (<code class=language-powershell>.</code>) refers to the current directory.<p>Move a file, named <em>some-file.txt</em>, from the current directory to the share:<pre class=language-powershell><code>Copy-Item -Path .\some-file.txt -Destination &lt;DRIVE_LETTER&gt;:</code></pre><p>Move a folder, named <em>some-folder</em>, from the current directory to the share:<pre class=language-powershell><code>Copy-Item -Path .\some-folder -Destination &lt;DRIVE_LETTER&gt;: -Recurse</code></pre><p>To move files and folders from the share to the current directory, use the <code class=language-powershell>Copy-Item</code> command reversing the <code class=language-powershell>-Path</code> and <code class=language-powershell>-Destination</code>.<p>Moving a file from the share to the current directory:<pre class=language-powershell><code>Copy-Item -Path &lt;DRIVE_LETTER&gt;:\some-file.txt -Destination .</code></pre><p>Moving a folder from the share to the current directory:<pre class=language-powershell><code>Copy-Item -Path &lt;DRIVE_LETTER&gt;:\some-folder -Destination . -Recurse</code></pre><p>The <code class=language-powershell>-Path</code> and <code class=language-powershell>-Destination</code> parameters are optional. The <code class=language-powershell>-Recurse</code> switch can be replaced with <code class=language-powershell>-r</code>. The <code class=language-powershell>cp</code> command will also invoke the <code class=language-powershell>Copy-Item</code> command. The following commands accomplish the same results as the longer commands above.<p>Move a file to the share:<pre class=language-powershell><code>cp .\some-file.txt &lt;DRIVE_LETTER&gt;:</code></pre><p>Move a folder to the share:<pre class=language-powershell><code>cp .\some-folder &lt;DRIVE_LETTER&gt;: -r</code></pre><p>Move a file from the share:<pre class=language-powershell><code>cp &lt;DRIVE_LETTER&gt;:\some-file.txt .</code></pre><p>Move a folder from the share:<pre class=language-powershell><code>cp &lt;DRIVE_LETTER&gt;:\some-folder . -r</code></pre><a id=conventions-used></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#conventions-used class=nostyle>Conventions Used</a></h3><p>In this tutorial, commands will be shown with placeholders [in angle brackets (<code class=language-powershell>&lt;...&gt;</code>)] for custom values that you must provide. Commands will also be shown with a set of naming conventions that will allow you to simply cut-and-paste the command for direct use, thus enhancing your enjoyment of the tutorial. The naming conventions used in this tutorial are shown in the table below.<table><thead><tr><th>Item<th>Name<tbody><tr><td>WS 2012 R2 Admin Username<td>adminuser<tr><td>Nano Server Admin Username<td>nanouser<tr><td>Azure Files File Share Container Name<td>data<tr><td>File Share Drive Letter<td>s<tr><td>ASP.NET Core Publish Output Folder*<td>c:\publish<tr><td>IIS Website Name<td>aspnetcore<tr><td>IIS Website Project Location on Nano Server<td><em>c:\publish</em><tr><td>IIS Website IIS Physical Path<td><em>c:\publish</em><tr><td>IIS Website Application Pool<td>aspnetcore</table>*For simplicity, we will place the published output on the c: drive, but you can modify the path to point to the published output of the projects's bin directory. <a id=it-infrastructure-security></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#it-infrastructure-security class=nostyle>IT infrastructure security</a></h3><p>Cyberattacks are a serious threat to company operations, and we should adopt strong security in our IT infrastructure to reduce the surface area for attacks and mitigate the damage from successful attacks. Before we get started with the tutorial, let's take a few minutes to go over an important security concept that will help us keep our servers safe.<p>A doctrine of infrastructure security is to limit the attack surface of our enterprise IT assets in part by limiting the number of management points to one or a few tightly-controlled management servers. Our goal is to limit our web servers' exposure to attacks from the public Internet by opening access to only those services that we require the web servers to perform for the public.<p>We will be creating a web server in this tutorial, so our goal is to only open ports 80 and 8000 (HTTP) and 443 (HTTPS) to the public Internet while locking-down all other public ports. Management and monitoring ports, such as 5985/5986 (WinRM ports for PowerShell remoting), will be open on a Virtual Network, where only our management server can gain access. As we add additional web servers to such a zone, we tremendously reduce the attack surface area compared to opening management and monitoring ports to the Internet on all of our web servers.<p>The importance of adopting strong security best practices cannot be understated. The number and sophistication of cyberattacks on enterprise IT infrastructure has ballooned in recent years. This tutorial cannot hope to instruct you in all of the best practices for secure server management to keep your organization safe from cyberattacks; however, we will adopt one important approach in this tutorial: limiting management points. This is one of many important practices that should be adopted. For more information and good starting points for further reading, visit <a href=https://technet.microsoft.com/en-us/library/windows-server-security.aspx>Windows Server Security (Microsoft TechNet)</a>, <a href="https://azure.microsoft.com/en-us/documentation/articles/best-practices-network-security/">Microsoft Cloud Services and Network Security</a>, and <a href=https://technet.microsoft.com/en-us/library/dd277328.aspx>Enterprise Security Best Practices</a>.</p><a id=azure-services-configuration></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-services-configuration class=nostyle>Azure Services Configuration</a></h2><p>Before we get started creating our VM's, let's create an Azure Resource Group, an Azure Storage Account (and an Azure Files network file share to go along with it), an Azure Virtual Network, and a pair of Network Security Groups (one for the management VM and one for the Nano Server). By preconfiguring these services, we will save time later when deploying our VM's.<div class=note><p><em>Note</em></p>Azure service names frequently expose public endpoints or require unique names internally, so the names we give to several Azure services are only available on a first-come, first-served basis. You should choose an alphanumeric postfix to use with your Azure service names as you work through the tutorial. For example, we will use the number "1234" in the tutorial and name our management VM <strong>vmm1234</strong>, name our virtual network <strong>vnet1234</strong>, and name our Nano Sever <strong>nano1234</strong>. You should choose a postfix alphanumeric value to use for your tutorial experience. This will provide a consistent way for you to name your services while working though the tutorial without the likelihood of trying to use a service name in use by someone else's Azure subscription.</div><a id=azure-resource-group></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-resource-group class=nostyle>Azure Resource Group</a></h3><ol><li>Navigate to the <strong>Azure Portal &lt;<a href="https://portal.azure.com/">https://portal.azure.com/</a>&gt;</strong>. Click the button for <strong>Resource Groups</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Click the <strong>Add</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-02.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>Supply a <strong>Resource group name</strong>, choose your <strong>Subscription</strong>, and select a <strong>Resource group location</strong> (Azure datacenter). We will use the name <em>group1234</em> for this tutorial and group our Azure services in the <strong>South Central US</strong> datacenter. Click the <strong>Create</strong> button to establish the resource group.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre_03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre_03.png style=max-width:100%;padding-bottom:20px></a> <a id=azure-storage-account></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-storage-account class=nostyle>Azure Storage Account</a></h3><ol><li>Click the button for <strong>Storage accounts</strong>. Be careful <strong>not</strong> to accidently click <strong>Storage accounts (classic)</strong> immediately below.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-04.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Click the <strong>Add</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-05.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>Provide a <strong>Name</strong>. We will use <em>storage1234</em> for this tutorial. Downgrade the storage <strong>Type</strong> to <strong>Standard-LRS</strong> and set <strong>Diagnostics</strong> to <strong>Disabled</strong>, which will be sufficient for demonstration purposes in this tutorial. Select the <strong>Subscription</strong> and choose the <strong>Resource Group</strong> we established earlier. Click the <strong>Create</strong> button to establish the storage account. Wait for the deployment to complete.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-06.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=4><li>Create an Azure Files network file share container and map it to a local network drive. The storage account properties blade will appear when the storage account deployment is complete. Click the <strong>Files</strong> button in the <strong>Services</strong> area.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-07.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-07.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>In the <strong>File shares</strong> area of the <strong>File service</strong> blade, click the button to create a file share.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-08.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-08.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=6><li>Create the file share by providing a <strong>Name</strong> (we will use <em>data</em>) and a <strong>Quota</strong> (<em>2</em> GB is plenty of space for our needs). Note that you will be charged for the space that you quote, so do not set aside much more space than you need. Click the <strong>Create</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-09.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-09.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=7><li>We will need the storage account key in future steps. Go back to the <strong>Storage account</strong> blade and click the <strong>All settings</strong> button, which will spawn the <strong>Settings</strong> blade. Open the <strong>Access keys</strong> blade and note the location of <strong>KEY1</strong>. You will be coming back to this blade later in the tutorial to obtain the storage account key. Of course, only cut-and-paste the key from the <strong>Azure Portal</strong> ... never store it unencrypted on any system.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-10.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-10.png style=max-width:100%;padding-bottom:20px></a> <a id=azure-virtual-network></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-virtual-network class=nostyle>Azure Virtual Network</a></h3><ol><li>In the <strong>Azure Portal</strong>, click the <strong>New</strong> button, followed by <strong>Networking</strong>, followed by <strong>Virtual network</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-11.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-11.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Set the <strong>Select a deployment model</strong> drop-down to <strong>Resource Manager</strong> and click the <strong>Create</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-12.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-12.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>The <strong>Create virtual network</strong> (VNet) blade will open. Provide a VNet <strong>Name</strong>. We will use <em>vnet1234</em> in the tutorial. We will use the default values provided by Azure, but you have an opportunity to set the <strong>Address space</strong>, <strong>Subnet name</strong>, and <strong>Subnet address range</strong> if you wish. Set the <strong>Resource group</strong> to the group you are using. In the tutorial, we established the resource group as <em>group1234</em>. You should select the resource group you created earlier. Click the <strong>Create</strong> button and wait for the deployment to complete.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-13.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-13.png style=max-width:100%;padding-bottom:20px></a> <a id=azure-network-security-group-management-vm></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-network-security-group-management-vm class=nostyle>Azure Network Security Group (management VM)</a></h3><p>The Network Security Group (NSG) for the management VM will be different than for our Nano Server. Our management VM will only have Remote Desktop Protocol (RDP, port 3389) open to the Internet, while the Nano Server will only open HTTP (ports 80 and 8000) and HTTPS (port 443) to the Internet. The management port that we will be using, Windows Remote Management (WinRM, port 5985), will only be open on the VNet between the two servers. Because we're locking-down management traffic to the VNet, we are vastly reducing the public attack surface of our Nano Server.<div class=note><p><em>Note</em></p>Naming network VNets, like naming servers, should adhere to a standard convention throughout the enterprise but is beyond the scope of this tutorial. If you are not familiar with naming conventions in networks, research the subject further.</div><div class=note><p><em>Note</em></p>Another best practice in server security is to use non-standard ports for services where possible. Ordinarily, we would choose a non-standard port for Remote Desktop and map it to the correct internal port for Remote Desktop (RDP, port 3389). This is not necessary for the tutorial and would overly complicate our demonstration, because to configure such a port mapping, we would need to add an Azure Load Balancer (LB) with Network Address Translation (NAT) rules. This is well beyond the scope of this tutorial; however, you can obtain more information on the subject in <a href="https://azure.microsoft.com/en-us/documentation/articles/load-balancer-arm-powershell/">Get started configuring an internet facing load balancer using Azure Resource Manager</a>.</div><ol><li>In the <strong>Azure Portal</strong>, click the <strong>Browse</strong> button and scroll down to click the <strong>Network security groups</strong> button. Be careful <strong>not</strong> to accidently click the <strong>Network security groups (classic)</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-14.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-14.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Click the <strong>Add</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-15.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-15.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>In the <strong>Create network security group</strong> blade, provide a <strong>Name</strong>, <strong>Subscription</strong>, and our <strong>Resource Group</strong>. In the tutorial, we will name the rule <em>vmm1234</em>. The abbreviation "vmm" stands for "virtual machine manager." Click the <strong>Create</strong> button and wait for the deployment to complete.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-16.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-16.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=4><li>When the deployment completes, the <strong>Azure Portal</strong> will open to the NSG we just created. It's time to add an inbound security rule for RDP (port 3389). In the <strong>Settings</strong>, click the <strong>Inbound security rules</strong> button, followed by the <strong>Add</strong> button in the <strong>Inbound security rules</strong> blade.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-17.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-17.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>We will add one rule for RDP (port 3389). In the <strong>Name</strong> field, provide the name <em>default-allow-rdp</em>. Bump the <strong>Priority</strong> up to 1000. Click the <strong>OK</strong> button to create the rule. After you click the <strong>OK</strong> button, there will be a short delay of a few seconds before the new rule will appear in the Azure Portal UI in the list of <strong>Inbound security rules</strong>. Wait for the rule to appear in the UI before proceeding.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-18.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-18.png style=max-width:100%;padding-bottom:20px></a> <a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-19.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-19.png style=max-width:100%;padding-bottom:20px></a> <br><div class=warning><p><em>Warning</em></p>There are additional security considerations for security rules beyond the scope of this tutorial. Good starting points for learning more are <a href="https://azure.microsoft.com/en-us/documentation/articles/best-practices-resource-manager-security/">Security considerations for Azure Resource Manager</a> and <a href="https://azure.microsoft.com/en-us/documentation/articles/virtual-networks-nsg/">Azure Network Security Groups</a>.</div><div class=note><p><em>Note</em></p>As with naming NVets and servers, naming schemes for security rules are also worthy of your further research. In the tutorial, we will prefix names with "default" to denote that they are the default rules to apply in each group, provide the action of the rule ("allow" or "deny"), and specify the protocol/port of the rule.</div><div class=note><p><em>Tip</em></p>Rules are processed in priority order lowest to highest (e.g., a rule with a <strong>Priority</strong> of 100 would be processed before a rule with a <strong>Priority</strong> of 200). Leave gaps between the rules that you create. When you return later to add new rules, you can add new rules in-between existing rules without editing existing rules. Note that once a rule is matched and applied, no further rules will be applied. If an early rule (lower <strong>Priority</strong> number) matches to deny the traffic and a later rule (higher <strong>Priority</strong> number) matches to allow the traffic, the traffic will be denied because the first rule (deny) matches and applies.</div><div class=note><p><em>Note</em></p>We do not need to create an outbound security rule for RDP (port 3389). When a request arrives on the inbound port or port range of an NSG, the outbound traffic of the response is automatically allowed.</div><div class=note><p><em>Note</em></p>If you would like to lock down the access to the management VM further by specifying a specific source IP address or range of IP addresses, you may do so with the <strong>CIDR block</strong> and <strong>Source</strong> settings. This is not necessary for the tutorial but will provide added security to your production networks, where limiting access to management points is critical.</div><a id=azure-network-security-group-nano-server-vm></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#azure-network-security-group-nano-server-vm class=nostyle>Network Security Group (Nano Server VM)</a></h3><p>Let's turn our attention to the NSG that we need for our Nano Server. The Nano Server will require open services for HTTP (port 80) and HTTPS (port 443) to receive and respond to requests from the Internet. Later, our ASP.NET Core application will be bound to HTTP on port 8000, so we will also open port 8000 in the NSG. Perform the following steps to create the NSG and add the inbound rules.<ol><li>Go back to the <strong>Network security groups</strong> blade by clicking <strong>Browse &gt; Network security groups</strong>. Click the <strong>Add</strong> button and provide a <strong>Name</strong> the NSG. In this tutorial, we will use <em>nano1234</em>, which will match the name of the Nano Server that we will create shortly. Set the <strong>Subscription</strong> and select the <strong>Resource Group</strong> you are using. In the tutorial, our Resource Group is called <em>group1234</em>. Click the <strong>Create</strong> button to create the NSG. Wait for the NSG to deploy. When it has deployed, the <strong>Azure Portal</strong> will open a blade to the NSG.<li>We will create the inbound rules for the Nano Server. There is no need to provide screenshots for this step, as the <strong>Azure Portal</strong> blades are identical to the ones we just used working with the management VM NSG. Click the <strong>Inbound security rules</strong> button. For each new rule, click the <strong>Add</strong> button, provide the rule information from the data shown below, and click the <strong>OK</strong> button to create each rule. You can create these rules one after the other without delaying between each addition; however, recall that you will need to wait for a few seconds after the final rule has been added to see it appear in the <strong>Inbound security rules</strong> blade. A screenshot is shown for the final NSG. Compare your NSG rules to the screenshot below and confirm your rules are correct.</ol><div class=note><p><em>Note</em></p>We do not need to open ports for management traffic between the management VM and the Nano Server on the VNet. A default rule is applied by Azure that allows inbound and outbound traffic on the VNet. For more information, see the <strong>Default Rules</strong> section of <a href="https://azure.microsoft.com/en-us/documentation/articles/virtual-networks-nsg/">What is a Network Security Group (NSG)?</a>.</div><dl><dt><em>NSG Rule for HTTP (Port 80) access</em><dd><ul><li><strong>Name</strong>: default-allow-http<li><strong>Priority</strong>: 1000<li><strong>Source</strong>: Any<li><strong>Protocol</strong>: Any<li><strong>Source port range</strong>: *<li><strong>Destination</strong>: Any<li><strong>Destination port range</strong>: 80<li><strong>Action</strong>: Allow</ul><dt><em>NSG Rule for HTTPS (Port 443) access</em><dd><ul><li><strong>Name</strong>: default-allow-https<li><strong>Priority</strong>: 1100<li><strong>Source</strong>: Any<li><strong>Protocol</strong>: Any<li><strong>Source port range</strong>: *<li><strong>Destination</strong>: Any<li><strong>Destination port range</strong>: 443<li><strong>Action</strong>: Allow</ul><dt><em>NSG Rule for HTTP (Port 8000) access for our ASP.NET Core app</em><dd><ul><li><strong>Name</strong>: allow-http-aspnetcore<li><strong>Priority</strong>: 1200<li><strong>Source</strong>: Any<li><strong>Protocol</strong>: Any<li><strong>Source port range</strong>: *<li><strong>Destination</strong>: Any<li><strong>Destination port range</strong>: 8000<li><strong>Action</strong>: Allow</ul></dl><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-20.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/pre-20.png style=max-width:100%;padding-bottom:20px></a> <a id=create-a-microsoft-azure-windows-server-2012-r2-vm></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#create-a-microsoft-azure-windows-server-2012-r2-vm class=nostyle>Create a Microsoft Azure Windows Server 2012 R2 VM</a></h2><p>First, we will create a management Azure VM to interact with our Nano Server, which we will be spinning up in a few minutes. The management VM shouldn't be used for any other purpose than managing other VM's. Because it will likely only be used in times of management, you can stop (deallocate) the VM in the <strong>Azure Portal</strong> when it isn't needed to reduce costs and start (allocate/deploy) the VM whenever you need it.<div class=note><p><em>Note</em></p>If you stop (deallocate) the management VM when not in use, you will obtain an even higher level of security, because no one can use a management VM for malicious purposes that isn't actually running. The most restrictive and safest management point philosophy is to have as few management points as possible, limit their exposure to attack, limit administrative scope for using them in the organization, and disable them when they are not actively serving a management role.</div><div class=note><p><em>Note</em></p>Storage charges for a stopped (deallocated) VM apply. See <a href="https://azure.microsoft.com/en-us/pricing/">Azure Pricing</a> for details.</div><ol><li>In the <strong>Azure Portal</strong>, click the button for <strong>Virtual machines</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Click the <strong>Add</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-02.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>In the <strong>Recommended</strong> section, click the <strong>Windows Server</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-03.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=4><li>Select <strong>Windows Server 2012 R2 Datacenter</strong> from the list. Be careful <strong>not</strong> to accidently select the <strong>Windows Server 2012 Datacenter</strong> (not R2) button immediately above it.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-04.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>Set the <strong>Select a deployment model</strong> drop-down to <strong>Resource Manager</strong> and click the <strong>Create</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-05.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=6><li>Next, we will configure our management server.</ol><div class=note><p><em>Note</em></p>Server naming conventions is an important subject but beyond the scope of this tutorial. We will use a simple name, <strong>vmm1234</strong>, for our management server. The abbreviation "vmm" stands for "virtual machine manager," and is a common abbreviation in server names used for this purpose. Many excellent blog posts, articles, and books address IT asset naming, and you are encouraged to research the subject further if unfamiliar.</div><div class=note><p><em>Note</em></p>Every asset that accepts credentials should have a unique username and password. If you aren't familiar with best practices in account usernames and password policies, you are encouraged to research the subject further.</div><p><strong>Basics</strong> blade: Provide a <strong>Name</strong>, <strong>User name</strong>, <strong>Password</strong>, <strong>Subscription</strong>, and <strong>Resource Group</strong>. Click <strong>OK</strong> to proceed to the <strong>Size</strong> blade.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-06.png style=max-width:100%;padding-bottom:20px></a> <br><p><strong>Size</strong> blade: Select a VM size. Click <strong>View All</strong> to see all of the available VM sizes. For this tutorial, we will use an <strong>A1 Standard</strong> VM size. Select a VM size and click the <strong>Select</strong> button.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-07.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-07.png style=max-width:100%;padding-bottom:20px></a> <br><p><strong>Storage</strong> blade: For the <strong>Disk type</strong>, we will accept the default <strong>Standard</strong>. Use the storage account and VNet we created earlier. Click the <strong>Public IP address</strong> button to open the <strong>Choose public IP address</strong> blade, which will default to <strong>Create new</strong> and further open the <strong>Create public IP address</strong> blade. On the <strong>Create public IP address</strong> blade, accept the default <strong>Name</strong> and set the <strong>Assignment</strong> to <strong>Static</strong>. Click <strong>OK</strong>.<p>The <strong>Azure Portal</strong> will default to a new <strong>Network security group</strong>, but we want to select the one we created earlier for the management VM. For the tutorial, this is the <em>vmm1234</em> NSG. We will set <strong>Diagnostics</strong> to <strong>Disabled</strong> and leave the <strong>Availability set</strong> on the default <strong>None</strong> value. Click the <strong>OK</strong> button to see the <strong>Summary</strong> blade.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-08.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-08.png style=max-width:100%;padding-bottom:20px></a> <a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-09.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-09.png style=max-width:100%;padding-bottom:20px></a> <br><div class=note><p><em>Note</em></p>We are setting a static public IP address for the management VM. When an Azure VM is stopped (deallocated), it will lose a dynamic public IP address. Since the tutorial is implying that the management VM can be stopped (deallocated) when it isn't in use and because we wish to use the same Remote Desktop Connection (RDP) settings file across management sessions, it's best to set a static public IP for this VM. If you prefer to leave the management VM with a dynamic public IP, then you will need to get a new Remote Desktop Connection (RDP) settings file from the <strong>Azure Portal</strong> each time you redeploy the VM in the <strong>Azure Portal</strong>. Note that there are pricing implications for assigning static public IP addresses. See the <strong>Reserved IP pricing</strong> section of <a href="https://azure.microsoft.com/en-us/pricing/details/ip-addresses/">IP Address pricing</a>.</div><p><strong>Summary</strong> blade: Click <strong>OK</strong> on the <strong>Summary</strong> blade to provision the VM.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-10.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-10.png style=max-width:100%;padding-bottom:20px></a> <br><p>Wait for the deployment to complete. The <strong>Azure Portal</strong> will display the <strong>Virtual machine</strong> blade when the deployment is complete. Click the <strong>Connect</strong> button to download the Remote Desktop Connection (RDP) settings file so that you can login to the management VM later.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-11.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/vmm-setup-11.png style=max-width:100%;padding-bottom:20px></a> <a id=create-a-microsoft-azure-nano-server-vm></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#create-a-microsoft-azure-nano-server-vm class=nostyle>Create a Microsoft Azure Nano Server VM</a></h2><ol><li>In the <strong>Azure Portal</strong>, click the button for <strong>Virtual machines</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Click the <strong>Add</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-02.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=3><li>In the <strong>Recommended</strong> section, click the <strong>Windows Server</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-03.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=4><li>Select <strong>Windows Server 2016 Nano Technical Preview 4</strong> from the list. Be careful <strong>not</strong> to accidently select the full <strong>Windows Server 2016 Technical Preview 4</strong> image immediately below the Nano Server image.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-04.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>Set the <strong>Select a deployment model</strong> drop-down to <strong>Resource Manager</strong> and click the <strong>Create</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-05.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=6><li>Next, we will configure the Nano Server.</ol><p><strong>Basics</strong> blade: Provide a <strong>Name</strong>, <strong>User name</strong>, <strong>Password</strong>, <strong>Subscription</strong>, and <strong>Resource Group</strong>. Click <strong>OK</strong> to proceed to the <strong>Size</strong> blade.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-06.png style=max-width:100%;padding-bottom:20px></a> <br><p><strong>Size</strong> blade: Select a VM size. Click <strong>View All</strong> to see all of the available VM sizes. For this tutorial, we will use an <strong>A1 Standard VM</strong>. Select the VM size and click the <strong>Select</strong> button.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-07.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-07.png style=max-width:100%;padding-bottom:20px></a> <br><p><strong>Storage</strong> blade: For the <strong>Disk type</strong>, we will accept the default <strong>Standard</strong>. Use the storage account and VNet we created earlier. We will accept the dynamic public IP address, since we have no intention of ever using Remote Desktop Connection with our Nano Server or have any other need for a static public IP address.<p>The <strong>Azure Portal</strong> will default to a new <strong>Network security group</strong>, but we want to select the one we created earlier for the Nano Server. For the tutorial, this is the <em>nano1234</em> NSG. We will leave the <strong>Availability set</strong> on the default <strong>None</strong> value. Click the <strong>OK</strong> button to see the <strong>Summary</strong> blade.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-08.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-08.png style=max-width:100%;padding-bottom:20px></a> <br><p><strong>Summary</strong> blade: Click <strong>OK</strong> on the <strong>Summary</strong> blade to provision the VM.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-09.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-09.png style=max-width:100%;padding-bottom:20px></a> <br><p>Wait for the deployment to complete. The <strong>Azure Portal</strong> will display the <strong>Virtual machine</strong> properties blade when the deployment is complete.<div class=note><p><em>Note</em></p>In spite of the presence of a functioning <strong>Connect</strong> button that will download a Remote Desktop Connection (RDP) settings file, keep in mind that Nano Server is not capable of using RDP. Any attempt to connect to a Nano Server with RDP will fail.</div><ol start=7><li>Let's give our Nano Server a DNS name label. In the <strong>Virtual machine</strong> blade, click on the Public IP address.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-10.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-10.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=8><li>The <strong>Public IP address</strong> blade and its <strong>Settings</strong> blade will appear. Click on the <strong>Configuration</strong> button in the <strong>Settings</strong> blade.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-11.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-11.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=9><li>Enter a <strong>DNS name label</strong> and click the <strong>Save</strong> button at the top of the blade. For the tutorial VM, we will use the name of the VM itself, <em>nano1234</em>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-12.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-setup-12.png style=max-width:100%;padding-bottom:20px></a> <a id=mount-the-azure-files-share-locally></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#mount-the-azure-files-share-locally class=nostyle>Mount the Azure Files share locally</a></h2><p>This tutorial will use a network file share to move files between our Nano Server and our local client computer. We've already created the Azure Files container that we need when we created our Azure Storage account earlier. We need to mount the container locally and on the Nano Server.<div class=note><p><em>Note</em></p>In the event you receive an Error 67 or an exception that the network location cannot be found when performing the following steps from your local machine, you are likely being blocked by your ISP. In that case, perform these steps once you have logged in on the WS 2012 R2 management VM we created. Deploy your application to the management VM (you can even cut-and-paste files between your local machine and the 2012 R2 machine), then use the file share from the management VM to deploy files to the Nano Server.</div><ol><li>To mount the file share locally, open a <strong>File Explorer</strong> window and click the <strong>Map network drive</strong> button.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Select a <strong>Drive</strong> letter and provide the share in UNC format (<em>\\server\container</em>) in the <strong>Folder</strong> field. The tutorial share uses the storage account <em>storage1234</em>, but you should substitute your storage account name for <em>storage1234</em>. Our tutorial share will connect to <em>\\storage1234.file.core.windows.net\data</em>. Check the box for <strong>Connect using different credentials</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-02.png style=max-width:100%;padding-bottom:20px></a> <br><div class=note><p><em>Note</em></p>We are not persisting our credentials for the share across reboots of the client computer in this tutorial. If you would like to persist the credentials with <code class=language-powershell>cmdkey</code> so that the share is persisted across reboots, check the box for <strong>Reconnect at sign-in</strong> and see <a href=http://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx>Persisting connections to Microsoft Azure Files</a> for instructions on the use of the <code class=language-powershell>cmdkey</code> to persist the credentials.</div><ol start=3><li>Enter network credentials for the share. The <strong>Username</strong> is the name of the storage account, <em>storage1234</em> for the tutorial. Use the name of your storage account in this field. The <strong>Password</strong> is the storage account key. Copy the key from the <strong>Azure Portal</strong> into the <strong>Password</strong> field. Click the <strong>OK</strong> button to connect.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-03.png style=max-width:100%;padding-bottom:20px></a> <br><p>When the connection is successful, Windows will immediately open a window to the share, which will be empty. We can now drag-and-drop or copy files via PowerShell into the share locally.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/share-04.png style=max-width:100%;padding-bottom:20px></a> <a id=access-the-nano-server-and-mount-the-azure-files-share></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#access-the-nano-server-and-mount-the-azure-files-share class=nostyle>Access the Nano Server and mount the Azure Files share</a></h2><ol><li>Earlier, we downloaded the Remote Desktop Connection (RDP) settings file for the management VM. Open the connection to the server by double-clicking the file. When you open the connection, you will be greeted by the Windows Security window. Click on <strong>Use another account</strong>, and provide the username ("adminuser" for the tutorial) and the password you created for the management VM.</ol><div class=warning><p><em>Warning</em></p>Although there is a convenient <strong>Remember my credentials</strong> checkbox available, <strong>never</strong> check this box to store credentials on the client machine, as there is a significant security risk in doing so.</div><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=2><li>Run the PowerShell ISE application on the management VM as an Administrator. Right-click its icon and select <strong>Run as administrator</strong> from the pop-up menu.<li>Add the Nano Server DNS name label to your local Trusted Hosts on the management VM. In the tutorial, we use <em>nano1234</em>. You should use the DNS address label for your Nano Server.</ol><pre class=language-powershell><code>Set-Item WSMan:\\localhost\\Client\\TrustedHosts "&lt;NANO_SERVER_DNS_NAME_LABEL&gt;"</code></pre><p>For the tutorial naming, we will use the following command.<pre class=language-powershell><code>Set-Item WSMan:\\localhost\\Client\\TrustedHosts "nano1234"</code></pre><p>Grant WinRM security configuration by clicking <strong>Yes</strong> in the pop-up window.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-02.png style=max-width:100%;padding-bottom:20px></a> <br><div class=note><p><em>Note</em></p>If you receive an exception when attempting to add the Nano Server to the Trusted Hosts list, confirm that your WinRM service is running in Windows OS Services.</div><ol start=4><li>Open a remote PowerShell session to your Nano Server using <strong>File &gt; New Remote PowerShell Tab...</strong> command in the <strong>File</strong> menu.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-03.png style=max-width:100%;padding-bottom:20px></a> <br><p>Provide the Nano Server DNS name in the <strong>Computer</strong> field and the VM Administrator account username in the <strong>User name</strong> field. Click the <strong>Connect</strong> button.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-04.png style=max-width:100%;padding-bottom:20px></a> <br><p>Provide your Nano Server VM Administrator account password in the <strong>Password</strong> field and click <strong>OK</strong> to connect. It will take several seconds to make the connection.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-05.png style=max-width:100%;padding-bottom:20px></a> <br><p>When the remote session opens, you will find yourself in the <em>Documents</em> folder of the Administrator's account on your Nano Server in a new PowerShell tab. We'll refer to henceforth in the tutorial to this PowerShell tab as the "<strong>remote</strong> PowerShell tab."</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-access-06.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>Execute the share drive mapping command in your <strong>remote</strong> PowerShell tab.</ol><pre class=language-powershell><code>net use &lt;DRIVE_LETTER&gt;: \\&lt;STORAGE_ACCOUNT&gt;.file.core.windows.net\&lt;CONTAINER&gt; &lt;STORAGE_ACCOUNT_KEY&gt; /user:&lt;STORAGE_ACCOUNT&gt; /persistent:no</code></pre><p>For the tutorial naming, we will use the following command.<pre class=language-powershell><code>net use s: \\storage1234.file.core.windows.net\data Tg3dg...d7w= /user:storage1234 /persistent:no</code></pre><p>PowerShell will respond with <strong>The command completed successfully</strong> on success. We now have access to the share on the Nano Server.</p><a id=install-nano-server-packages></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#install-nano-server-packages class=nostyle>Install Nano Server packages</a></h2><ol><li>The Reverse Forwarders packages is now installed by default on Nano Server Technology Preview 5, so we only need to install the IIS packages. Execute the following commands</ol><pre class=language-powershell><code>Install-PackageProvider NanoServerPackage
Import-PackageProvider NanoServerPackage
mkdir c:\packages
Save-Package provider NanoServerPackage -Name Microsoft-NanoServer-IIS-Package -Path c:\packages</code></pre>Create a text file named unattend.xml on your client computer with the following contents:<pre class=language-powershell><code>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;unattend xmlns="urn:schemas-microsoft-com:unattend"&gt;
&lt;servicing&gt;
&lt;package action="install"&gt;
	&lt;assemblyIdentity name="Microsoft-NanoServer-IIS-Package" version="10.0.10586.0" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" /&gt;
	&lt;source location="c:\packages\Microsoft-NanoServer-IIS-Package.cab" /&gt;
&lt;/package&gt;
&lt;package action="install"&gt;
	&lt;assemblyIdentity name="Microsoft-NanoServer-IIS-Package" version="10.0.10586.0" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="en-US" /&gt;
	&lt;source location="c:\packages\en-us\Microsoft-NanoServer-IIS-Package.cab" /&gt;
&lt;/package&gt;
&lt;/servicing&gt;
&lt;cpi:offlineImage cpi:source="" xmlns:cpi="urn:schemas-microsoft-com:cpi" /&gt;
&lt;/unattend&gt;</code></pre><p>Be sure to save the file in XML format with an .xml file extension. You can save the unattend.xml file directly to the share.<p>Copy the unattend.xml file to the Nano Server Documents directory in your **remote** PowerShell tab:<pre class=language-powershell><code>cp DRIVE_LETTER:\unattend.xml c:\Users\&lt;Username&gt;\Documents</code></pre><p>For the tutorial Nano Server, the command is <pre class=language-powershell><code>cp s:\unattend.xml c:\Users\adminuser\Documents</code></pre><p>Run this command from the Documents directory in your **remote** PowerShell tab to install IIS packages:<pre class=language-powershell><code>dism /online /apply-unattend:.\unattend.xml</code></pre><p>You will receive a 0x80004005 error ("DISM failed. No operation was performed"), but you can safely ignore it.<div class=note><p><em>Note</em></p>The Reverse Forwarders packages, which are now installed by default, provide shims for Win API calls to earlier libraries and new OneCore libraries allowing the calls to succeed without recompiling and linking for the new libraries. The Reverse Forwarders packages are currently required for <code class=language-powershell>libuv</code>, which is a key library supporting the Kestrel server of ASP.NET Core. The packages are also required for the ASP.NET Core Module module to forward calls to OneCore libraries.</div><ol start=2><li>Confirm that the IIS OnDemand package and its associated Language Pack is installed correctly with the following command.</ol><pre class=language-powershell><code>dism /online /get-packages</code></pre><ol start=3><li>Manually create a pair of compressed files folders for our applications' application pools. The <em>Default Web Site</em> uses the <em>DefaultAppPool</em>. The .NET Core application we will create in this tutorial will be called <em>aspnetcore</em>, and we'll use an AppPool by the same name. Run the following two commands in your <strong>remote</strong> PowerShell tab to create the folders we need for caching compressed static content on the Nano Server.</ol><pre class=language-powershell><code>mkdir "C:\inetpub\temp\IIS Temporary Compressed Files\DefaultAppPool"
mkdir "C:\inetpub\temp\IIS Temporary Compressed Files\aspnetcore"</code></pre><ol start=4><li>Start the W3SVC service with the following command.</ol><pre class=language-powershell><code>net start w3svc</code></pre><p>The VM will respond with the following output.<pre class=language-powershell><code>The World Wide Web Publishing Service service is starting.
The World Wide Web Publishing Service service was started successfully.</code></pre><ol start=5><li>Confirm that IIS is serving requests by visiting the <em>Default Web Site</em> in a browser. The IIS start page should be returned. You can access the website at either the Nano Server's public IP address or at its Fully Qualified Domain Name (FQDN).</ol><pre class=language-powershell><code>http://&lt;NANO_SERVER_VM_PUBLIC_IP_ADDRESS&gt;

http://&lt;NANO_SERVER_DNS_NAME_LABEL&gt;.&lt;DATACENTER&gt;.cloudapp.azure.com</code></pre><p>The tutorial <em>Default Web Site</em> will be returned at the following addresses.<pre class=language-powershell><code>http://138.91.197.182

http://nano1234.westus.cloudapp.azure.com</code></pre><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-02.png style=max-width:100%;padding-bottom:20px></a> <a id=install-the-aspnetcoremodule></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#install-the-aspnetcoremodule class=nostyle>Install the AspNetCoreModule</a></h2><p>The <em>aspnetcore.dll</em> on Windows normally resides at <em>%windir%\System32\inetsrv\aspnetcore.dll</em>. If you've previously installed the 64-bit version of the AspNetCoreModule locally, you may use this filepath to move the DLL to your Nano Server. If you have not installed the module, you may obtain the 64-bit version at <a href=http://download.microsoft.com/download/7/2/D/72DD68D5-7386-4A41-8B8F-E21779A69E33/aspnetcoremodule_x64_en.msi>x64 Installer</a>.<div class=note><p><em>Note</em></p>If you attempt to install the module on your local development machine, and you receive a dialog box stating that "The IIS 7.0 CoreWebEngine and W3SVC features must be installed to use Microsoft ASP.NET Core Module Preview," then run the installer on the 2012 R2 management VM that we created. It will install the module on the VM. You can find the aspnetcore.dll and aspnetcore_schema.xml files on the VM in the same locations as shown for a local install. Move both files to the network file share, then proceed to install them on the Nano Server by copying them as shown below.</div><div class=note><p><em>Note</em></p>You should only move the 64-bit version of the AspNetCoreModule to Nano Server, as 32-bit support (WOW64) is not available on Nano Server.</div><div class=note><p><em>Note</em></p>Installation of the AspNetCoreModule is a manual operation at this time. An installer for the module will be provided in the future.</div><ol><li>Copy the <em>aspnetcore.dll</em> and its schema file from your local system to the share. Not all local installs of the AspNetCoreModule install the schema file. Check your local system to determine if the schema file is present by opening <em>c:\Windows\System32\inetsrv\config\schema</em> and looking for a file named <em>aspnetcore_schema.xml</em>. If the file is not present, create it in a text editor with the following contents.</ol><pre class=language-powershell><code>&lt;!--
IIS Asp.Net Core Extension Schema
** Please DO NOT edit this file yourself. **
If you want to add configuration sections to the schema, you may place
them in .xml files similar to this one, in this directory. They will be
picked up automatically on startup.
--&gt;

&lt;configSchema&gt;
&lt;sectionSchema name="system.webServer/aspNetCore"&gt;
&lt;attribute name="processPath" type="string" expanded="true"/&gt;
&lt;attribute name="arguments" type="string" expanded="true" defaultValue=""/&gt;
&lt;attribute name="startupTimeLimit" type="uint" defaultValue="120" validationType="integerRange" validationParameter="0,3600"/&gt; &lt;!-- in seconds --&gt;
&lt;attribute name="startupRetryCount" type="uint" defaultValue="10" validationType="integerRange" validationParameter="0,100"/&gt;
&lt;attribute name="shutdownTimeLimit" type="uint" defaultValue="10" validationType="integerRange" validationParameter="0,600"/&gt; &lt;!-- in seconds --&gt;
&lt;attribute name="rapidFailsPerMinute" type="uint" defaultValue="10" validationType="integerRange" validationParameter="0,100"/&gt;
&lt;attribute name="requestTimeout" type="timeSpan" defaultValue="00:02:00" validationType="timeSpanRange" validationParameter="0,2592000,60"/&gt;
&lt;attribute name="stdoutLogEnabled" type="bool" defaultValue="false" /&gt;
&lt;attribute name="stdoutLogFile" type="string" defaultValue=".\aspnetcore-stdout" expanded="true"/&gt;
&lt;attribute name="processesPerApplication" type="uint" defaultValue="1" validationType="integerRange" validationParameter="1,100"/&gt;
&lt;attribute name="forwardWindowsAuthToken" type="bool" defaultValue="false" /&gt;
&lt;element name="recycleOnFileChange"&gt;
&lt;collection addElement="file" clearElement="clear"&gt;
&lt;attribute name="path" type="string" required="true" validationType="nonEmptyString" expanded="true"/&gt;
&lt;/collection&gt;
&lt;/element&gt;
&lt;element name="environmentVariables"&gt;
&lt;collection addElement="environmentVariable" clearElement="clear" &gt;
&lt;attribute name="name" type="string" required="true" validationType="nonEmptyString"/&gt;
&lt;attribute name="value" type="string" required="true"/&gt;
&lt;/collection&gt;
&lt;/element&gt;
&lt;/sectionSchema&gt;
&lt;/configSchema&gt;</code></pre><p>Be sure to save the file in XML format with an <em>.xml</em> file extension. Be careful when saving the file from a text editor, such as NotePad. When you have extensions for known file types hidden in your local operating system, an XML file may appear in directories as <em>some-file.xml</em> but will actually be known as <em>some-file.xml.txt</em> to the OS. The file's actual extension will show correctly in your PowerShell session tabs and in the file's properties.<p>Drag-and-drop the the module DLL and the schema file to the share on your local client computer.<ol start=2><li>Copy the <em>aspnetcore.dll</em> and <em>aspnetcore_schema.xml</em> schema file into the <em>inetserv</em> and <em>inetserv\config\schema</em> directories in your <strong>remote</strong> PowerShell tab on the management VM.</ol><pre class=language-powershell><code>cp &lt;DRIVE_LETTER&gt;:\aspnetcore.dll c:\Windows\System32\inetsrv

cp &lt;DRIVE_LETTER&gt;:\aspnetcore_schema.xml c:\Windows\System32\inetsrv\config\schema</code></pre><p>For the tutorial Nano Server, we will use the following commands.<pre class=language-powershell><code>cp s:\aspnetcore.dll c:\Windows\System32\inetsrv

cp s:\aspnetcore_schema.xml c:\Windows\System32\inetsrv\config\schema</code></pre><ol start=3><li><strong>RESTART the Nano Server VM</strong>. In your <strong>remote</strong> PowerShell tab, close the session with the following command.</ol><pre class=language-powershell><code>Exit-PSSession</code></pre><p>Close the <strong>remote</strong> PowerShell tab. We will open a new tab in a moment after the VM restarts.<p>In the <strong>Azure Portal</strong>, click the <strong>Restart</strong> button on the Nano Server <strong>Virtual machine</strong> blade. Wait for the Nano Server to restart. Reconnect to the VM in PowerShell by selecting <strong>File &gt; New Remote PowerShell Tab...</strong> and providing your credentials for the Nano Server VM Administrator account. Wait for a few seconds while the session is established by PowerShell ISE. Re-attach the share with the following command.<pre class=language-powershell><code>net use &lt;DRIVE_LETTER&gt;: \\&lt;STORAGE_ACCOUNT&gt;.file.core.windows.net\&lt;CONTAINER&gt; &lt;STORAGE_ACCOUNT_KEY&gt; /user:&lt;STORAGE_ACCOUNT&gt; /persistent:no</code></pre><p>For the tutorial naming, we will use the following command.<pre class=language-powershell><code>net use s: \\storage1234.file.core.windows.net\data Tg3dg...d7w= /user:storage1234 /persistent:no</code></pre><ol start=4><li>Backup the <em>applicationHost.config</em> file using the following command in your <strong>remote</strong> PowerShell tab.</ol><pre class=language-powershell><code>cp c:\Windows\System32\inetsrv\config\applicationHost.config &lt;DRIVE_LETTER&gt;:\</code></pre><p>For the tutorial Nano Server, we will use the following command.<pre class=language-powershell><code>cp c:\Windows\System32\inetsrv\config\applicationHost.config s:</code></pre><ol start=5><li>Install the <em>IISAdministration</em> module in the <strong>remote</strong> PowerShell tab. The <em>IISAdministration</em> module provides commands for working with IIS in a PowerShell session. For more information, see <a href=https://technet.microsoft.com/en-us/library/mt270166.aspx>IIS Administration Cmdlets</a>.</ol><pre class=language-powershell><code>Import-Module IISAdministration</code></pre><ol start=6><li>Update the <em>applicationHost.config</em> file on the Nano Server VM to provide IIS with access to the module. Paste the following PowerShell script into the script area of the <strong>remote</strong> PowerShell tab:</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-03.png style=max-width:100%;padding-bottom:20px></a> <br><pre class=language-powershell><code>$sm = Get-IISServerManager
# Add AppSettings section (for Asp.Net Core)
$sm.GetApplicationHostConfiguration().RootSectionGroup.Sections.Add("appSettings")
# Unlock the handlers section
$appHostconfig = $sm.GetApplicationHostConfiguration()
$section = $appHostconfig.GetSection("system.webServer/handlers")
$section.OverrideMode="Allow"
# Add aspNetCore section to system.webServer
$sectionAspNetCore = $appHostConfig.RootSectionGroup.SectionGroups["system.webServer"].Sections.Add("aspNetCore")
$sectionAspNetCore.OverrideModeDefault = "Allow"
# Add to globalModules
$globalModules = Get-IISConfigSection "system.webServer/globalModules" | Get-IISConfigCollection
New-IISConfigCollectionElement $globalModules -ConfigAttribute @{"name"="AspNetCoreModule";"image"="%SystemRoot%\system32\inetsrv\aspnetcore.dll"}
# Add to modules
$modules = Get-IISConfigSection "system.webServer/modules" | Get-IISConfigCollection
New-IISConfigCollectionElement $modules -ConfigAttribute @{"name"="AspNetCoreModule"}
# Commit Changes
$sm.CommitChanges()</code></pre><p>Click the <strong>Run</strong> button to execute the commands.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-05.png style=max-width:100%;padding-bottom:20px></a> <br><p>Close the script tab without saving. We will never want to run this script again on this VM, as the <em>applicationHost.config</em> file only requires these updates once in order to use the AspNetCoreModule module in IIS.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/nano-install-06.png style=max-width:100%;padding-bottom:20px></a> <br><div class=warning><p><em>Warning</em></p><strong>Do not</strong> run this script multiple times. If you execute commands in this script multiple times, you will add elements more than once, and the applicationHost.config file will become corrupt and break IIS. If the file is corrupted by accident: (1) Restore the file from the known-good version previously saved to the share, (2) Run this script once on the restored applicationHost.config file, and (3) Close the script tab and do not save the script.</div><div class=note><p><em>Note</em></p>When an installer is created for the AspNetCoreModule for Nano Server, the manual modifications we just made to the <strong>applicationHost.config</strong> file will be executed automatically by the installer.</div><a id=deploy-an-asp-net-core-core-clr-app></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#deploy-an-asp-net-core-core-clr-app class=nostyle>Deploy an ASP.NET Core Core CLR app</a></h2><p>Web Deploy will eventually be supported for Nano Server, and XCopy should work now. A custom PowerShell script is also an option for moving projects to your Nano Server. This tutorial will simply rely upon copying the project to the VM using the share we have created.<ol><li>Create or obtain an ASP.NET Core Core CLR x64 project.</ol><div class=note><p><em>Note</em></p>Nano Server does not support .NET Framework or 32-bit (<code class=language-powershell>clr</code>) projects. The project must depend on a 64-bit Core CLR runtime and packages.</div><ol start=2><li>Move your ASP.NET Core project to the share. Drag-and-drop your published output folder to the share on your local client computer. Because even a small .NET Core standalone project will be over 50MB, this might take several minutes to complete on a slow Internet connection. Wait for the project copy operation to complete before proceeding.<li>Copy the project from the share to the Nano Server using the <code class=language-powershell>cp</code> command with <code class=language-powershell>-r</code> (<code class=language-powershell>-Recurse</code>) in your <strong>remote</strong> PowerShell tab. We will place the application at the root of the <em>c:</em> drive.</ol><pre class=language-powershell><code>cp &lt;DRIVE_LETTER&gt;:\&lt;OUTPUT_FOLDER&gt; c:\&lt;PATH_TO_WHERE_APPLICATION_WILL_RESIDE_ON_NANO_SERVER&gt; -r</code></pre><p>For the tutorial application, we will use the following command.<pre class=language-powershell><code>cp s:\publish c:\ -r</code></pre><ol start=4><li>Configure the website Application Pool (AppPool) by executing the following commands. You can paste these commands into a PowerShell <strong>Script</strong> tab in the <strong>remote</strong> PowerShell tab and run them with the <strong>Run</strong> button, or you can execute the commands at the PowerShell command line prompt in the <strong>remote</strong> PowerShell tab.</ol><pre class=language-powershell><code>$sm.ApplicationPools.Add("&lt;IIS_WEBSITE_NAME&gt;")$sm.CommitChanges()</code></pre><p>For the tutorial application, we will use the following commands.<pre class=language-powershell><code>$sm.ApplicationPools.Add("aspnetcore")
$sm.CommitChanges()</code></pre><ol start=5><li>Start the AppPool.</ol><pre class=language-powershell><code>$ap = Get-IISAppPool -Name "&lt;IIS_WEBSITE_NAME&gt;"
$ap.Start()</code></pre><p>For the tutorial AppPool, we will use the following commands.<pre class=language-powershell><code>$ap = Get-IISAppPool -Name "aspnetcore"
$ap.Start()</code></pre><p>Confirm the AppPool is running with the following command.<pre class=language-powershell><code>$sm.ApplicationPools</code></pre><ol start=6><li>Create an IIS website on port 8000 and assign the AppPool we created for it.</ol><pre class=language-powershell><code>Start-IISCommitDelay
$mysite = New-IISSite -Name "&lt;IIS_WEBSITE_NAME&gt;" -BindingInformation "*:8000:" -PhysicalPath "&lt;PATH_TO_WHERE_APPLICATION_WILL_RESIDE_ON_NANO_SERVER&gt;" -Passthru
$mysite.Applications["/"].ApplicationPoolName = "&lt;IIS_WEBSITE_NAME&gt;"
Stop-IISCommitDelay</code></pre><p>For the tutorial Nano Server application, we will use the following commands.<pre class=language-powershell><code>Start-IISCommitDelay
$mysite = New-IISSite -Name "aspnetcore" -BindingInformation "*:8000:" -PhysicalPath "c:\publish" -Passthru
$mysite.Applications["/"].ApplicationPoolName = "aspnetcore"
Stop-IISCommitDelay</code></pre><ol start=7><li>Open port 8000 on the firewall.</ol><pre class=language-powershell><code>New-NetFirewallRule -Name "&lt;IIS_WEBSITE_NAME&gt;" -DisplayName "HTTP on TCP/8000" -Protocol tcp -LocalPort 8000 -Action Allow -Enabled True</code></pre><p>For the tutorial Nano Server IIS, we will use the following command.<pre class=language-powershell><code>New-NetFirewallRule -Name "aspnetcore" -DisplayName "HTTP on TCP/8000" -Protocol tcp -LocalPort 8000 -Action Allow -Enabled True</code></pre><ol start=8><li>Confirm the application is available by opening an Internet browser and navigating to the following addresses.</ol><pre class=language-powershell><code>http://&lt;NANO_SERVER_VM_PUBLIC_IP_ADDRESS&gt;:8000

http://&lt;NANO_SERVER_DNS_NAME_LABEL&gt;.&lt;DATACENTER&gt;.cloudapp.azure.com:8000</code></pre><p>For the tutorial Nano Server, the following addresses will return the IIS Start Page.<pre class=language-powershell><code>http://138.91.197.182:8000

http://nano1234.westus.cloudapp.azure.com:8000</code></pre><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/deploy-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/deploy-01.png style=max-width:100%;padding-bottom:20px></a><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/deploy_02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/deploy_02.png></a> <br><p>Congratulations &amp; Enjoy!<div class=note><p><em>Note</em></p>The public IP address of the Nano Server is dynamically allocated by Azure. It will remain stable as long as the Nano Server isn't stopped (deallocated) and restarted (allocated) in the <strong>Azure Portal</strong>. Since we gave the Nano Server a stable DNS address label, we will always be able to reach it via the FQDN (i.e., the azure.com address) no matter what public IP address Azure allocates to the VM across re-deployments of the VM. If you would prefer a static public IP address for your Nano Server, configure it at any time in the <strong>Azure Portal</strong> the same way we configured the static public IP address for the management VM.</div><a id=clean-up></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#clean-up class=nostyle>Clean Up</a></h2><ol><li>Exit the PowerShell <strong>remote</strong> session with the following command.</ol><pre class=language-powershell><code>Exit-PSSession</code></pre><p>You may close the <strong>remote</strong> PowerShell tab.<ol start=2><li>Except for the known-good <em>applicationHost.config</em> file, remove other files and folders from the share, unless you plan to use the share during the creation of new IIS Nano Servers. If you have no further use of the share, you may delete it in the <strong>Azure Portal</strong>.<li>If your management VM will only be used intermittently, you can stop (deallocate) the management VM to save money. Note that storage space taken up by the VM will continue to accrue charges. See <a href="https://azure.microsoft.com/en-us/pricing/">Azure Pricing</a> for details.</ol><a id=nano-server-management></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#nano-server-management class=nostyle>Nano Server Management</a></h2><p>We will outline four sources of information that will help you manage your Nano Server deployments and troubleshoot issues with the VM, IIS, and your ASP.NET Core applications. This is not an exhaustive set of management options. We will examine how the VM's events are available through a remote Server Manager, a remote Event Log, the IIS log files, and the AspNetCoreModule log. For other management and troubleshooting options, see <a href=https://technet.microsoft.com/en-us/library/mt126167.aspx>Getting Started with Nano Server</a>.</p><a id=connecting-to-a-remote-server-manager></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#connecting-to-a-remote-server-manager class=nostyle>Connecting to a remote Server Manager</a></h3><ol><li>Login to your WS 2012 R2 management server.<li>If you haven't already done so, add the Nano Server DNS name label to the server's Trusted Hosts by executing the following command from an elevated PowerShell prompt.</ol><pre class=language-powershell><code>Set-Item WSMan:\localhost\Client\TrustedHosts "&lt;NANO_SERVER_DNS_NAME_LABEL&gt;"</code></pre><p>For our tutorial Nano Server, we will use the following command.<pre class=language-powershell><code>Set-Item WSMan:\localhost\Client\TrustedHosts "nano1234"</code></pre><p>Agree to modify the Trusted Hosts list for the WinRM client by typing <em>y</em> (yes) and pressing <em>Enter</em> on your keyboard when the pop-up window appears.<ol start=3><li>Obtain the subnet address of the Nano Server from the <strong>Azure Portal</strong> on the <strong>Virtual network</strong> blade. The <strong>IP ADDRESS</strong> for the Nano Server will appear in the <strong>Connected devices</strong> area next to the <strong>Network interface</strong> connected to the Nano Server. For the tutorial Nano Server, the subnet address is <em>10.5.0.5</em>. Add the subnet address of the Nano Server to our management VM's <em>Hosts</em> file. Open <em>File Explorer</em> and paste the address of the hosts file into the address bar.</ol><p><em>C:\Windows\system32\drivers\etc\hosts</em></p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-01.png style=max-width:100%;padding-bottom:20px></a> <br><p>The OS will request how you would like to open the file. Select <strong>Notepad</strong> from the list.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-02.png style=max-width:100%;padding-bottom:20px></a> <br><p>Enter the Nano Server's subnet address and its DNS address label with at least one space in between. Save the file and close <em>File Explorer</em>. See the example below for the tutorial Nano Server. This addition to the file will take effect immediately, so there is no need to restart the server.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-03.png style=max-width:100%;padding-bottom:20px></a> <br><div class=note><p><em>Note</em></p>The subnet address shown, 10.5.0.5, is for the tutorial Nano Server. You must obtain the subnet address of your Nano Server in the <strong>Azure Portal</strong>.</div><ol start=4><li>Store the Nano Server's username and password on the management VM. You must run the following command from an elevated Windows command prompt or from an elevated PowerShell command prompt (not PowerShell ISE).</ol><pre class=language-powershell><code>cmdkey /add:&lt;NANO_SERVER_DNS_NAME_LABEL&gt; /user:&lt;NANO_SERVER_DNS_NAME_LABEL&gt;\&lt;USERNAME&gt; /pass</code></pre><p>For our tutorial Nano Server, we will use the following command.<pre class=language-powershell><code>cmdkey /add:nano1234 /user:nano1234\nanouser /pass</code></pre><p>Type the password for the Nano Server Administrator account and press <em>Enter</em> on the keyboard. The server will respond <strong>CMDKEY: Credential added successfully.</strong></p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-04.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-04.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>We need to ensure several ports are open on the Nano Server to allow access by the Server Manager. Open a <strong>remote</strong> PowerShell tab to the Nano Server by selecting <strong>File &gt; New Remote PowerShell Tab...</strong> and entering the credentials for the Nano Server's Administrator account.</ol><p>The following ports must be open.<ul><li>Remote Service Management (NP-In)<li>Remote Service Management (RPC)<li>Remote Service Management (RPC-EPMAP)<li>Remote Event Log Management (NP-In)<li>Remote Event Log Management (RPC)<li>Remote Event Log Management (RPC-EPMAP)<li>Windows Firewall Remote Management (RPC)<li>Windows Firewall Remote Management (RPC-EPMAP)</ul><p>You do not need to enable these firewall rules on the management server ... only on the Nano Server. You also do not need to be concerned about the Azure NSG's in place, because port traffic on the VNet between the management VM and the Nano Server VM is allowed by default via a default rule given to the VNet by Azure.<p>Execute the following commands in the <strong>remote</strong> PowerShell tab.<pre class=language-powershell><code>Enable-NetFirewallRule -DisplayName "Remote Service Management (NP-In)"
Enable-NetFirewallRule -DisplayName "Remote Service Management (RPC)"
Enable-NetFirewallRule -DisplayName "Remote Service Management (RPC-EPMAP)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (NP-In)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (RPC)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (RPC-EPMAP)"
Enable-NetFirewallRule -DisplayName "Windows Firewall Remote Management (RPC)"
Enable-NetFirewallRule -DisplayName "Windows Firewall Remote Management (RPC-EPMAP)"</code></pre><p>For more information on Server Manager, see <a href=https://technet.microsoft.com/en-us/library/hh831456.aspx>Manage Multiple, Remote Servers with Server Manager</a>.<ol start=6><li>Click the <strong>Add other servers to manage</strong> button in the Server Manager's <strong>Dashboard</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-05.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-05.png style=max-width:100%;padding-bottom:20px></a> <br><p>You can also add the Nano Server by selecting <strong>Add Servers</strong> in the <strong>Manage</strong> drop-down menu.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-06.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-06.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=7><li>Click the <strong>DNS</strong> tab and provide the DNS name of the Nano Server VM in the <strong>Search</strong> field. Click the magnifying glass (search).</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-07.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-07.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=8><li>The Nano Server will appear with its subnet address. Click the button on the right to add the server.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-08.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-08.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=9><li>Click the <strong>OK</strong> button to add the server to Server Manager.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-09.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-09.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=10><li>This should connect your Nano Server to Server Manager on the management VM. Click <strong>All Servers</strong> and click on the Nano Server to see its <strong>Events</strong>, <strong>Services</strong>, and <strong>Roles and Features</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-10.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-10.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=11><li>If you right-click the Nano Server and <strong>Refresh</strong> it in the pop-up menu, a red <strong>Refresh failed</strong> bar will appear. Click <strong>More...</strong> to see the refresh failures.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-11.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-11.png style=max-width:100%;padding-bottom:20px></a> <br><p>These exceptions are normal at this time for Nano Server. The first exception refers to the Best Practices Analyzer, which does not run on Nano Server at this time. The second exception refers to performance counter data, which is also not available on Nano Server at this time. It's safe to ignore these notifications.</p><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-12.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-1-12.png style=max-width:100%;padding-bottom:20px></a> <a id=connecting-to-a-remote-event-log></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#connecting-to-a-remote-event-log class=nostyle>Connecting to a remote Event Log</a></h3><ol><li>Login to your WS 2012 R2 management server.<li>If you haven't already done so, add the Nano Server DNS name label to the server's Trusted Hosts by executing the following command from an elevated PowerShell prompt.</ol><pre class=language-powershell><code>Set-Item WSMan:\localhost\Client\TrustedHosts "&lt;NANO_SERVER_ DNS_NAME_LABEL&gt;"</code></pre><p>Agree to modify the Trusted Hosts list for the WinRM client by typing <em>y</em> and pressing <em>Enter</em> on your keyboard.<ol start=3><li>We need to ensure several ports are open on the Nano Server to allow access by the remote Event Log. Open a <strong>remote</strong> PowerShell tab to the Nano Server by selecting <strong>File &gt; New Remote PowerShell Tab...</strong> and entering the credentials for the Nano Server's Administrator account.</ol><p>The following ports must be open.<ul><li>Windows Management Instrumentation (DCOM-In)<li>Remote Event Log Management (RPC)<li>Remote Event Log Management (RPC-EPMAP)<li>Remote Event Log Management (NP-In)</ul><p>You do not need to enable these firewall rules on the management server ... only on the Nano Server. You also do not need to be concerned about the Azure NSG's in place, because port traffic on the VNet between the management VM and the Nano Server VM is allowed by default via a default rule given to the VNet by Azure.<p>Execute the following commands in the <strong>remote</strong> PowerShell tab.<pre class=language-powershell><code>Enable-NetFirewallRule -DisplayName "Windows Management Instrumentation (DCOM-In)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (RPC)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (RPC-EPMAP)"
Enable-NetFirewallRule -DisplayName "Remote Event Log Management (NP-In)"</code></pre><ol start=4><li>Open the Event Viewer on the management server. From the <strong>Action</strong> menu, select <strong>Connect to Another Computer...</strong>.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-01.png style=max-width:100%;padding-bottom:20px></a> <br><ol start=5><li>In the <strong>Select Computer</strong> pop-up window, enter the Nano Server VM DNS name in the <strong>Another computer</strong> field. Click <strong>OK</strong> and wait for the Event Viewer to connect to the Nano Server and load its events.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-02.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-02.png style=max-width:100%;padding-bottom:20px></a><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-03.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-2-03.png style=max-width:100%;padding-bottom:20px></a> <a id=examining-iis-log-files></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#examining-iis-log-files class=nostyle>Examining IIS log files</a></h3><p>In a <strong>remote</strong> PowerShell tab, find the IIS log files by navigating to the following locations.<ul><li><strong>Failed Request Log Files</strong>: <em>C:\inetpub\logs\FailedReqLogFiles</em><li><strong>IIS Log File Folders</strong>: <em>C:\inetpub\logs\LogFiles</em></ul><a id=aspnetcoremodule-log-files></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#aspnetcoremodule-log-files class=nostyle>AspNetCoreModule log files</a></h3><ol><li>Check your application's <code class=language-powershell>aspNetCore</code> element in the <em>web.config</em> file. It should specify that log files are enabled with a path to the <em>logs</em> folder. Note that you supply a prefix for the log file filenames; however, the AspNetCoreModule will add a timestamp and the file extension for you.</ol><pre class=language-powershell><code>&lt;aspNetCore processPath=".\my_app.exe" arguments="" stdoutLogEnabled="true" stdoutLogFile=".\logs\log" startupTimeLimit="3600" /&gt;</code></pre><ol start=2><li>After you've made at least one successful request to the application, log files will be generated in the project's <em>logs</em> folder. Note how the timestamp and extension were added automatically.</ol><a href=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-4-01.png><img alt="" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 class=lazy data-src=http://rexsite.azureedge.net/aspnet-core-on-nano-server/management-4-01.png style=max-width:100%;padding-bottom:20px></a> <a id=useful-iis-powershell-commands></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#useful-iis-powershell-commands class=nostyle>Useful IIS PowerShell Commands</a></h2><a id=general-commands></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#general-commands class=nostyle>General Commands</a></h3><p>To set the physical path of the <em>Default Web Site</em> to something other than the default in <em>c:\inetpub</em>, use the following commands.<pre class=language-powershell><code>$sm = Get-IISServerManager
$mysite = $sm.Sites["Default Web Site"]
$mysite.Applications[0].VirtualDirectories[0].PhysicalPath = "c:\publish"
$sm.CommitChanges()</code></pre><p>To set the physical path of the Default Web Site back to the default location, use the following commands.<pre class=language-powershell><code>$mysite = $sm.Sites["Default Web Site"]
$mysite.Applications[0].VirtualDirectories[0].PhysicalPath = "%SystemDrive%\inetpub"
$sm.CommitChanges()</code></pre><p>To get IIS Server Manager object information, use the following command.<pre class=language-powershell><code>$sm = Get-IISServerManager</code></pre><p>To list websites, then application pools, use the following commands.<pre class=language-powershell><code>$sm.Sites
$sm.ApplicationPools</code></pre><p>To get an IIS website, then stop and start the site, use the following commands.<pre class=language-powershell><code>$mysite = $sm.Sites["&lt;IIS_WEBSITE_NAME&gt;"]
$mysite.Stop()
$mysite.Start()</code></pre><p>To get the IIS Application Pools, use the following command.<pre class=language-powershell><code>Get-IISAppPool</code></pre><p>To get a specific AppPool, then stop, start, and recycle it, use the following commands.<pre class=language-powershell><code>$ap = Get-IISAppPool -Name "&lt;APPPOOL_NAME&gt;"
$ap.Stop()
$ap.Start()
$ap.Recycle()</code></pre><p>To create a new website, use the following command.<pre class=language-powershell><code>New-IISSite -Name &lt;IIS_WEBSITE_NAME&gt; -BindingInformation "*:&lt;PORT&gt;:www.mydomain.com" -PhysicalPath &lt;PATH_TO_PROJECT_FOLDER&gt;</code></pre><a id=setting-up-for-tls-app-access></a><h3><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#setting-up-for-tls-app-access class=nostyle>Setting up for TLS app access</a></h3><p>To install an SSL certificate on Nano Server and configure IIS website bindings, use the following commands.<p>First, install the certificate.<pre class=language-powershell><code>certoc.exe -ImportPFX -p &lt;CERT_PFX_PASSWORD&gt; My c:\mycert.pfx</code></pre><p>Obtain the thumbprint of the certificate with the following command.<pre class=language-powershell><code>Get-ChildItem Cert:\LocalMachine\my</code></pre><p>Use the thumbprint to create the website binding with the following commands.<pre class=language-powershell><code>$cert = Get-Item Cert:\LocalMachine\my\&lt;THUMBPRINT&gt;
$hash = $cert.GetCertHash()
$sm.Sites["&lt;IIS_WEBSITE_NAME&gt;"].Bindings.Add("*:443:", $hash, "My", "0")
$sm.CommitChanges()</code></pre><p>If you would like an SNI binding, use the following command.<pre class=language-powershell><code>$sm.Sites["&lt;IIS_WEBSITE_NAME&gt;"].Bindings.Add("*:443:www.mydomain.com", $hash, "My", "Sni")</code></pre><a id=additional-resources></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#additional-resources class=nostyle>Additional Resources</a></h2><ul><li><a href="http://docs.asp.net/en/latest/publishing/">ASP.NET Core Publishing and Deployment</a><li><a href=https://technet.microsoft.com/en-us/library/mt126167.aspx>Getting Started with Nano Server</a><li><a href="http://blogs.technet.com/b/nanoserver/">Nano Server TechNet Blog</a><li><a href=https://channel9.msdn.com/Series/Nano-Server-Team>The Nano Server Channel (Channel 9)</a><li><a href=https://technet.microsoft.com/en-us/library/mt627783.aspx>IIS on Nano Server</a><li><a href=https://technet.microsoft.com/en-us/library/mt270166.aspx>IIS Administration Cmdlets</a><li><a href=http://blogs.technet.com/b/nanoserver/archive/2015/11/19/nano-server-iaas-image-in-the-azure-gallery.aspx>Nano Server IaaS Image in the Azure Gallery</a> (TechNet Blogs, Nov. 24, 2015), Refaat Issa<li><a href=http://blogs.iis.net/bariscaglar/iisadministration-powershell-cmdlets-new-feature-in-windows-10-server-2016>IISAdministration PowerShell Cmdlets (New feature in Windows 10 / Server 2016)</a><li><a href=https://msdn.microsoft.com/en-us/library/azure/mt125356.aspx>Azure Resource Manager Cmdlets</a><li><a href=https://technet.microsoft.com/en-us/library/mt270159.aspx>Get-IISConfigSection</a><li><a href=https://channel9.msdn.com/Events/ASPNET-Events/ASPNET-Fall-Sessions/IIS-and-Nano-Server>IIS and Nano Server</a> (ASP.NET Fall Sessions, Nov. 3, 2015), David So, Principal Software Engineer<li><a href=https://channel9.msdn.com/Events/DEVintersection/DEVintersection-2015/Nano-Server-The-Future-of-Windows-Server-Starts-Now>Nano Server: The Future of Windows Server Starts Now</a> (DEVintersection, Oct. 27, 2015), Jeffrey Snover, Distinguished Engineer Microsoft and the Lead Architect for the Windows Server and System Center Division<li><a href=https://channel9.msdn.com/Series/Nano-Server-Team/Nano-Server-and-Azure-PowerShell>Nano Server and Azure PowerShell</a><li><a href=https://technet.microsoft.com/en-us/library/mt156917.aspx>PowerShell: Windows Server 2016 Technical Preview and Windows 10</a><li><a href=https://technet.microsoft.com/en-us/library/hh825236.aspx>What is DISM?</a></ul><a id=acknowledgements></a><h2><svg aria-hidden=true height=16 version=1.1 viewbox="0 0 16 16" width=16><path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path></svg> <a href=#acknowledgements class=nostyle>Acknowledgements</a></h2><ul><li>David So, Principal Software Engineer, <a href="http://www.microsoft.com/">Microsoft Corporation</a><li>Pawel Kadluczka, Senior Software Development Engineer, <a href="http://www.microsoft.com/">Microsoft Corporation</a><li>Ben A. Adams, CTO, <a href="http://www.illyriad.co.uk/">Illyriad Games</a></ul></article><hr><a class=nostyle style=margin-top:12px;float:right href=https://github.com/guardrex/guardrex.com><img src="https://ci.appveyor.com/api/projects/status/idjmmibiqgta0ox0/branch/master?svg=true" alt="Project Badge" width=140></a><table id=social_bottom><tbody><tr><td><a href="https://twitter.com/home?status=Check%20out%20%40guardrex%20blog%20post%20ASP%2ENET%20Core%20on%20Nano%20Server"><svg role=img aria-labelledby="twitter twitter_desc" height=28 width=28 xmlns=http://www.w3.org/2000/svg viewBox="0 0 28 28"><title id=twitter>Tweet</title><desc id=twitter_desc>Share on Twitter</desc><path fill=#26c4f1 d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62a15.093 15.093 0 0 1-8.86-2.32c2.702.18 5.375-.648 7.507-2.32a5.417 5.417 0 0 1-4.49-3.64c.802.13 1.62.077 2.4-.154a5.416 5.416 0 0 1-4.412-5.11 5.43 5.43 0 0 0 2.168.387A5.416 5.416 0 0 1 2.89 4.498a15.09 15.09 0 0 0 10.913 5.573 5.185 5.185 0 0 1 3.434-6.48 5.18 5.18 0 0 1 5.546 1.682 9.076 9.076 0 0 0 3.33-1.317 5.038 5.038 0 0 1-2.4 2.942 9.068 9.068 0 0 0 3.02-.85 5.05 5.05 0 0 1-2.48 2.71z" /></svg></a><td><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html"><svg role=img aria-labelledby="facebook facebook_desc" height=29 width=29 xmlns=http://www.w3.org/2000/svg viewBox="0 0 29 29"><title id=facebook>Facebook</title><desc id=facebook_desc>Share on Facebook</desc><path fill=#306199 d="M26.4 0H2.6C1.714 0 0 1.715 0 2.6v23.8c0 .884 1.715 2.6 2.6 2.6h12.393V17.988h-3.996v-3.98h3.997v-3.062c0-3.746 2.835-5.97 6.177-5.97 1.6 0 2.444.173 2.845.226v3.792H21.18c-1.817 0-2.156.9-2.156 2.168v2.847h5.045l-.66 3.978h-4.386V29H26.4c.884 0 2.6-1.716 2.6-2.6V2.6c0-.885-1.716-2.6-2.6-2.6z" /></svg></a><td><a href="https://plus.google.com/share?url=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html"><svg role=img aria-labelledby="google google_desc" xmlns=http://www.w3.org/2000/svg width=24 height=24 viewBox="0 0 24 24"><title id=google>Google+</title><desc id=google_desc>Share on Google+</desc><path fill=#e93f2e d="M21 8.29h-1.95v2.6h-2.6v1.82h2.6v2.6H21v-2.6h2.6v-1.885H21V8.29zM7.614 10.306v2.925h3.9c-.26 1.69-1.755 2.925-3.9 2.925-2.34 0-4.29-2.016-4.29-4.354s1.885-4.353 4.29-4.353c1.104 0 2.014.326 2.794 1.105l2.08-2.08c-1.3-1.17-2.924-1.883-4.874-1.883C3.65 4.586.4 7.835.4 11.8s3.25 7.212 7.214 7.212c4.224 0 6.953-2.988 6.953-7.082 0-.52-.065-1.104-.13-1.624H7.614z"></path></svg></a><td><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A//www.guardrex.com/post/aspnet-core-on-nano-server.html&amp;title=ASP%2ENET%20Core%20on%20Nano%20Server&amp;summary=Check%20out%20%40guardrex%20blog%20post%20ASP%2ENET%20Core%20on%20Nano%20Server&amp;source=!social_source"><svg role=img aria-labelledby="linkedin linkedin_desc" xmlns=http://www.w3.org/2000/svg width=28 height=28 viewBox="0 0 28 28"><title id=linkedin>Linkedin</title><desc id=linkedin_desc>Share on Linkedin</desc><path fill=#007bb6 d="M25.424 15.887v8.447h-4.896v-7.882c0-1.98-.71-3.33-2.48-3.33-1.354 0-2.158.91-2.514 1.802-.13.315-.162.753-.162 1.194v8.216h-4.9s.067-13.35 0-14.73h4.9v2.087c-.01.017-.023.033-.033.05h.032v-.05c.65-1.002 1.812-2.435 4.414-2.435 3.222 0 5.638 2.106 5.638 6.632zM5.348 2.5c-1.676 0-2.772 1.093-2.772 2.54 0 1.42 1.066 2.538 2.717 2.546h.032c1.71 0 2.77-1.132 2.77-2.546C8.056 3.593 7.02 2.5 5.344 2.5h.005zm-2.48 21.834h4.896V9.604H2.867v14.73z"></path></svg></a></table><hr><div id=disqus_thread></div><footer><div class=container style="padding:20px 0;text-align:center"><p>Copyright &copy;2017 Luke Latham All Rights Reserved.</div></footer></div><script>(function(){'use strict';if(navigator.userAgent.match(/IEMobile\/10\.0/)){var msViewportStyle=document.createElement('style')
msViewportStyle.appendChild(document.createTextNode('@-ms-viewport{width:auto!important}'))
document.querySelector('head').appendChild(msViewportStyle)}
var colors=new Array([62,35,255],[60,255,60],[255,35,98],[45,175,230],[255,0,255],[255,128,0]);var step=0;var colorIndices=[0,1,2,3];var gradientSpeed=0.002;function updateGradient()
{var c0_0=colors[colorIndices[0]];var c0_1=colors[colorIndices[1]];var c1_0=colors[colorIndices[2]];var c1_1=colors[colorIndices[3]];var istep=1-step;var r1=Math.round(istep*c0_0[0]+step*c0_1[0]);var g1=Math.round(istep*c0_0[1]+step*c0_1[1]);var b1=Math.round(istep*c0_0[2]+step*c0_1[2]);var color1="rgb("+r1+","+g1+","+b1+")";var r2=Math.round(istep*c1_0[0]+step*c1_1[0]);var g2=Math.round(istep*c1_0[1]+step*c1_1[1]);var b2=Math.round(istep*c1_0[2]+step*c1_1[2]);var color2="rgb("+r2+","+g2+","+b2+")";document.getElementById("gradient").style.background="-webkit-gradient(linear, left top, right top, from("+color1+"), to("+color2+"))";document.getElementById("gradient").style.background="-moz-linear-gradient(left, "+color1+" 0%, "+color2+" 100%)";step+=gradientSpeed;if(step>=1){step%=1;colorIndices[0]=colorIndices[1];colorIndices[2]=colorIndices[3];colorIndices[1]=(colorIndices[1]+Math.floor(1+Math.random()*(colors.length-1)))%colors.length;colorIndices[3]=(colorIndices[3]+Math.floor(1+Math.random()*(colors.length-1)))%colors.length;}}
if(document.getElementById("gradient")!=null){document.getElementById("header_container").style.borderBottom="none";document.getElementById("social_top").style.display="none";document.getElementById("disqus_thread").style.display="none";setInterval(updateGradient,10);}
registerListener('load',setLazy);registerListener('load',lazyLoad);registerListener('scroll',lazyLoad);var lazy=[];function setLazy(){lazy=document.getElementsByClassName('lazy');console.log('Found '+lazy.length+' lazy images');}
function lazyLoad(){for(var i=0;i<lazy.length;i++){if(isInViewport(lazy[i])){if(lazy[i].getAttribute('data-src')){lazy[i].src=lazy[i].getAttribute('data-src');lazy[i].removeAttribute('data-src');}}}
cleanLazy();}
function cleanLazy(){lazy=Array.prototype.filter.call(lazy,function(l){return l.getAttribute('data-src');});}
function isInViewport(el){var rect=el.getBoundingClientRect();return(rect.bottom>=0&&rect.right>=0&&rect.top<=(window.innerHeight||document.documentElement.clientHeight)&&rect.left<=(window.innerWidth||document.documentElement.clientWidth));}
function registerListener(event,func){if(window.addEventListener){window.addEventListener(event,func)}else{window.attachEvent('on'+event,func)}}
var d=document,s=d.createElement('script');s.src='https://guardrex.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={manual:_self.Prism&&_self.Prism.manual,util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var i=r[e];if(2==arguments.length){a=arguments[1];for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}var o={};for(var s in i)if(i.hasOwnProperty(s)){if(s==t)for(var l in a)a.hasOwnProperty(l)&&(o[l]=a[l]);o[s]=i[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var i in e)e.hasOwnProperty(i)&&(t.call(e,i,e[i],a||i),"Object"!==n.util.type(e[i])||r[n.util.objId(e[i])]?"Array"!==n.util.type(e[i])||r[n.util.objId(e[i])]||(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,i,r)):(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,i=a.elements||document.querySelectorAll(a.selector),l=0;r=i[l++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var i,l,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(i=(o.className.match(e)||[,""])[1].toLowerCase(),l=n.languages[i]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+i,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+i);var s=t.textContent,u={element:t,language:i,grammar:l,code:s};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(n.hooks.run("before-highlight",u),u.element.textContent=u.code,n.hooks.run("after-highlight",u)),n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var g=new Worker(n.filename);g.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},g.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var i=n.tokenize(e,t);return a.stringify(n.util.encode(i),r)},matchGrammar:function(e,t,a,r,i,l,o){var s=n.Token;for(var u in a)if(a.hasOwnProperty(u)&&a[u]){if(u==o)return;var g=a[u];g="Array"===n.util.type(g)?g:[g];for(var c=0;c<g.length;++c){var h=g[c],f=h.inside,d=!!h.lookbehind,m=!!h.greedy,p=0,y=h.alias;if(m&&!h.pattern.global){var v=h.pattern.toString().match(/[imuy]*$/)[0];h.pattern=RegExp(h.pattern.source,v+"g")}h=h.pattern||h;for(var b=r,k=i;b<t.length;k+=t[b].length,++b){var w=t[b];if(t.length>e.length)return;if(!(w instanceof s)){h.lastIndex=0;var _=h.exec(w),P=1;if(!_&&m&&b!=t.length-1){if(h.lastIndex=k,_=h.exec(e),!_)break;for(var A=_.index+(d?_[1].length:0),j=_.index+_[0].length,x=b,O=k,S=t.length;S>x&&(j>O||!t[x].type&&!t[x-1].greedy);++x)O+=t[x].length,A>=O&&(++b,k=O);if(t[b]instanceof s||t[x-1].greedy)continue;P=x-b,w=e.slice(k,O),_.index-=k}if(_){d&&(p=_[1].length);var A=_.index+p,_=_[0].slice(p),j=A+_.length,N=w.slice(0,A),C=w.slice(j),E=[b,P];N&&(++b,k+=N.length,E.push(N));var L=new s(u,f?n.tokenize(_,f):_,y,_,m);if(E.push(L),C&&E.push(C),Array.prototype.splice.apply(t,E),1!=P&&n.matchGrammar(e,t,a,b,k,!0,u),l)break}else if(l)break}}}}},tokenize:function(e,t){var a=[e],r=t.rest;if(r){for(var i in r)t[i]=r[i];delete t.rest}return n.matchGrammar(e,a,t,0,0,!1),a},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,i=0;r=a[i++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var i={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==i.type&&(i.attributes.spellcheck="true"),e.alias){var l="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(i.classes,l)}n.hooks.run("wrap",i);var o=Object.keys(i.attributes).map(function(e){return e+'="'+(i.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+(o?" "+o:"")+">"+i.content+"</"+i.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,i=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),i&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,!document.addEventListener||n.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);Prism.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\s\S])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\s\S]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup;Prism.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,"function":/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag));Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[[^\]\r\n]+]|\\.|[^\/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript;Prism.languages.csharp=Prism.languages.extend("clike",{keyword:/\b(abstract|as|async|await|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/,string:[{pattern:/@("|')(\1\1|\\\1|\\?(?!\1)[\s\S])*\1/,greedy:!0},{pattern:/("|')(\\?.)*?\1/,greedy:!0}],number:/\b-?(0x[\da-f]+|\d*\.?\d+f?)\b/i}),Prism.languages.insertBefore("csharp","keyword",{"generic-method":{pattern:/[a-z0-9_]+\s*<[^>\r\n]+?>\s*(?=\()/i,alias:"function",inside:{keyword:Prism.languages.csharp.keyword,punctuation:/[<>(),.:]/}},preprocessor:{pattern:/(^\s*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(\s*#)\b(define|elif|else|endif|endregion|error|if|line|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});Prism.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(`?[\s\S])*?"/,greedy:!0,inside:{"function":{pattern:/[^`]\$\(.*?\)/,inside:{}}}},{pattern:/'([^']|'')*'/,greedy:!0}],namespace:/\[[a-z][\s\S]*?\]/i,"boolean":/\$(true|false)\b/i,variable:/\$\w+\b/i,"function":[/\b(Add-(Computer|Content|History|Member|PSSnapin|Type)|Checkpoint-Computer|Clear-(Content|EventLog|History|Item|ItemProperty|Variable)|Compare-Object|Complete-Transaction|Connect-PSSession|ConvertFrom-(Csv|Json|StringData)|Convert-Path|ConvertTo-(Csv|Html|Json|Xml)|Copy-(Item|ItemProperty)|Debug-Process|Disable-(ComputerRestore|PSBreakpoint|PSRemoting|PSSessionConfiguration)|Disconnect-PSSession|Enable-(ComputerRestore|PSBreakpoint|PSRemoting|PSSessionConfiguration)|Enter-PSSession|Exit-PSSession|Export-(Alias|Clixml|Console|Csv|FormatData|ModuleMember|PSSession)|ForEach-Object|Format-(Custom|List|Table|Wide)|Get-(Alias|ChildItem|Command|ComputerRestorePoint|Content|ControlPanelItem|Culture|Date|Event|EventLog|EventSubscriber|FormatData|Help|History|Host|HotFix|Item|ItemProperty|Job|Location|Member|Module|Process|PSBreakpoint|PSCallStack|PSDrive|PSProvider|PSSession|PSSessionConfiguration|PSSnapin|Random|Service|TraceSource|Transaction|TypeData|UICulture|Unique|Variable|WmiObject)|Group-Object|Import-(Alias|Clixml|Csv|LocalizedData|Module|PSSession)|Invoke-(Command|Expression|History|Item|RestMethod|WebRequest|WmiMethod)|Join-Path|Limit-EventLog|Measure-(Command|Object)|Move-(Item|ItemProperty)|New-(Alias|Event|EventLog|Item|ItemProperty|Module|ModuleManifest|Object|PSDrive|PSSession|PSSessionConfigurationFile|PSSessionOption|PSTransportOption|Service|TimeSpan|Variable|WebServiceProxy)|Out-(Default|File|GridView|Host|Null|Printer|String)|Pop-Location|Push-Location|Read-Host|Receive-(Job|PSSession)|Register-(EngineEvent|ObjectEvent|PSSessionConfiguration|WmiEvent)|Remove-(Computer|Event|EventLog|Item|ItemProperty|Job|Module|PSBreakpoint|PSDrive|PSSession|PSSnapin|TypeData|Variable|WmiObject)|Rename-(Computer|Item|ItemProperty)|Reset-ComputerMachinePassword|Resolve-Path|Restart-(Computer|Service)|Restore-Computer|Resume-(Job|Service)|Save-Help|Select-(Object|String|Xml)|Send-MailMessage|Set-(Alias|Content|Date|Item|ItemProperty|Location|PSBreakpoint|PSDebug|PSSessionConfiguration|Service|StrictMode|TraceSource|Variable|WmiInstance)|Show-(Command|ControlPanelItem|EventLog)|Sort-Object|Split-Path|Start-(Job|Process|Service|Sleep|Transaction)|Stop-(Computer|Job|Process|Service)|Suspend-(Job|Service)|Tee-Object|Test-(ComputerSecureChannel|Connection|ModuleManifest|Path|PSSessionConfigurationFile)|Trace-Command|Unblock-File|Undo-Transaction|Unregister-(Event|PSSessionConfiguration)|Update-(FormatData|Help|List|TypeData)|Use-Transaction|Wait-(Event|Job|Process)|Where-Object|Write-(Debug|Error|EventLog|Host|Output|Progress|Verbose|Warning))\b/i,/\b(ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(\W?)(!|-(eq|ne|gt|ge|lt|le|sh[lr]|not|b?(and|x?or)|(Not)?(Like|Match|Contains|In)|Replace|Join|is(Not)?|as)\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/},Prism.languages.powershell.string[0].inside.boolean=Prism.languages.powershell.boolean,Prism.languages.powershell.string[0].inside.variable=Prism.languages.powershell.variable,Prism.languages.powershell.string[0].inside.function.inside=Prism.util.clone(Prism.languages.powershell);</script>